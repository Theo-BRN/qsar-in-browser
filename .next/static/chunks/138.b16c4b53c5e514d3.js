"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[138],{4091:function(t,e,r){r.r(e),r.d(e,{isAnyArray:function(){return isAnyArray}});let s=Object.prototype.toString;function isAnyArray(t){let e=s.call(t);return e.endsWith("Array]")&&!e.includes("Big")}},5823:function(t,e,r){r.r(e),r.d(e,{default:function(){return rescale}});var s=r(4091);function rescale(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((0,s.isAnyArray)(t)){if(0===t.length)throw TypeError("input must not be empty")}else throw TypeError("input must be an array");if(void 0!==r.output){if(!(0,s.isAnyArray)(r.output))throw TypeError("output option must be an array if specified");e=r.output}else e=Array(t.length);var i=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,s.isAnyArray)(t))throw TypeError("input must be an array");if(0===t.length)throw TypeError("input must not be empty");var r=e.fromIndex,i=void 0===r?0:r,o=e.toIndex,n=void 0===o?t.length:o;if(i<0||i>=t.length||!Number.isInteger(i))throw Error("fromIndex must be a positive integer smaller than length");if(n<=i||n>t.length||!Number.isInteger(n))throw Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[i],h=i+1;h<n;h++)t[h]<a&&(a=t[h]);return a}(t),o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,s.isAnyArray)(t))throw TypeError("input must be an array");if(0===t.length)throw TypeError("input must not be empty");var r=e.fromIndex,i=void 0===r?0:r,o=e.toIndex,n=void 0===o?t.length:o;if(i<0||i>=t.length||!Number.isInteger(i))throw Error("fromIndex must be a positive integer smaller than length");if(n<=i||n>t.length||!Number.isInteger(n))throw Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[i],h=i+1;h<n;h++)t[h]>a&&(a=t[h]);return a}(t);if(i===o)throw RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var n=r.min,a=void 0===n?r.autoMinMax?i:0:n,h=r.max,l=void 0===h?r.autoMinMax?o:1:h;if(a>=l)throw RangeError("min option must be smaller than max option");for(var u=(l-a)/(o-i),c=0;c<t.length;c++)e[c]=(t[c]-i)*u+a;return e}},8406:function(t,e,r){var s=r(4091),i=r(5823);let o=" ".repeat(2),n=" ".repeat(4);function inspectMatrixWithOptions(t,e={}){let{maxRows:r=15,maxColumns:s=10,maxNumSize:i=8,padMinus:a="auto"}=e;return`${t.constructor.name} {
${o}[
${n}${function(t,e,r,s,i){let{rows:o,columns:a}=t,h=Math.min(o,e),l=Math.min(a,r),u=[];if("auto"===i){i=!1;t:for(let e=0;e<h;e++)for(let r=0;r<l;r++)if(0>t.get(e,r)){i=!0;break t}}for(let e=0;e<h;e++){let r=[];for(let o=0;o<l;o++){var c,f;r.push((c=t.get(e,o),f=i,(c>=0&&f?` ${formatNumber2(c,s-1)}`:formatNumber2(c,s)).padEnd(s)))}u.push(`${r.join(" ")}`)}return l!==a&&(u[u.length-1]+=` ... ${a-r} more columns`),h!==o&&u.push(`... ${o-e} more rows`),u.join(`
${n}`)}(t,r,s,i,a)}
${o}]
${o}rows: ${t.rows}
${o}columns: ${t.columns}
}`}function formatNumber2(t,e){let r=t.toString();if(r.length<=e)return r;let s=t.toFixed(e);if(s.length>e&&(s=t.toFixed(Math.max(0,e-(s.length-e)))),s.length<=e&&!s.startsWith("0.000")&&!s.startsWith("-0.000"))return s;let i=t.toExponential(e);return i.length>e&&(i=t.toExponential(Math.max(0,e-(i.length-e)))),i.slice(0)}function checkRowIndex(t,e,r){let s=r?t.rows:t.rows-1;if(e<0||e>s)throw RangeError("Row index out of range")}function checkColumnIndex(t,e,r){let s=r?t.columns:t.columns-1;if(e<0||e>s)throw RangeError("Column index out of range")}function checkRowVector(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw RangeError("vector size must be the same as the number of columns");return e}function checkColumnVector(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw RangeError("vector size must be the same as the number of rows");return e}function checkRowIndices(t,e){if(!s.isAnyArray(e))throw TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw RangeError("row indices are out of range")}function checkColumnIndices(t,e){if(!s.isAnyArray(e))throw TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw RangeError("column indices are out of range")}function checkRange(t,e,r,s,i){if(5!=arguments.length)throw RangeError("expected 4 arguments");if(checkNumber("startRow",e),checkNumber("endRow",r),checkNumber("startColumn",s),checkNumber("endColumn",i),e>r||s>i||e<0||e>=t.rows||r<0||r>=t.rows||s<0||s>=t.columns||i<0||i>=t.columns)throw RangeError("Submatrix indices are out of range")}function newArray(t,e=0){let r=[];for(let s=0;s<t;s++)r.push(e);return r}function checkNumber(t,e){if("number"!=typeof e)throw TypeError(`${t} must be a number`)}function checkNonEmpty(t){if(t.isEmpty())throw Error("Empty matrix has no elements to index")}let AbstractMatrix=class AbstractMatrix{static from1DArray(t,e,r){if(t*e!==r.length)throw RangeError("data length does not match given dimensions");let s=new Matrix(t,e);for(let i=0;i<t;i++)for(let t=0;t<e;t++)s.set(i,t,r[i*e+t]);return s}static rowVector(t){let e=new Matrix(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new Matrix(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new Matrix(t,e)}static ones(t,e){return new Matrix(t,e).fill(1)}static rand(t,e,r={}){if("object"!=typeof r)throw TypeError("options must be an object");let{random:s=Math.random}=r,i=new Matrix(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++)i.set(r,t,s());return i}static randInt(t,e,r={}){if("object"!=typeof r)throw TypeError("options must be an object");let{min:s=0,max:i=1e3,random:o=Math.random}=r;if(!Number.isInteger(s))throw TypeError("min must be an integer");if(!Number.isInteger(i))throw TypeError("max must be an integer");if(s>=i)throw RangeError("min must be smaller than max");let n=i-s,a=new Matrix(t,e);for(let r=0;r<t;r++)for(let t=0;t<e;t++){let e=s+Math.round(o()*n);a.set(r,t,e)}return a}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let s=Math.min(t,e),i=this.zeros(t,e);for(let t=0;t<s;t++)i.set(t,t,r);return i}static diag(t,e,r){let s=t.length;void 0===e&&(e=s),void 0===r&&(r=e);let i=Math.min(s,e,r),o=this.zeros(e,r);for(let e=0;e<i;e++)o.set(e,e,t[e]);return o}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,s=t.columns,i=new Matrix(r,s);for(let o=0;o<r;o++)for(let r=0;r<s;r++)i.set(o,r,Math.min(t.get(o,r),e.get(o,r)));return i}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,s=t.columns,i=new this(r,s);for(let o=0;o<r;o++)for(let r=0;r<s;r++)i.set(o,r,Math.max(t.get(o,r),e.get(o,r)));return i}static checkMatrix(t){return AbstractMatrix.isMatrix(t)?t:new Matrix(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!=typeof t)throw TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,e=0,r=-1,s=!0,i=!1;for(;t<this.rows&&s;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(i=!0,r=e):(s=!1,i=!0);t++}return s}isReducedEchelonForm(){let t=0,e=0,r=-1,s=!0,i=!1;for(;t<this.rows&&s;){for(e=0,i=!1;e<this.columns&&!1===i;)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(i=!0,r=e):(s=!1,i=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(s=!1);t++}return s}echelonForm(){let t=this.clone(),e=0,r=0;for(;e<t.rows&&r<t.columns;){let s=e;for(let i=e;i<t.rows;i++)t.get(i,r)>t.get(s,r)&&(s=i);if(0===t.get(s,r))r++;else{t.swapRows(e,s);let i=t.get(e,r);for(let s=r;s<t.columns;s++)t.set(e,s,t.get(e,s)/i);for(let s=e+1;s<t.rows;s++){let i=t.get(s,r)/t.get(e,r);t.set(s,r,0);for(let o=r+1;o<t.columns;o++)t.set(s,o,t.get(s,o)-t.get(e,o)*i)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,s=r-1;for(;s>=0;)if(0===t.maxRow(s))s--;else{let i=0,o=!1;for(;i<r&&!1===o;)1===t.get(s,i)?o=!0:i++;for(let r=0;r<s;r++){let o=t.get(r,i);for(let n=i;n<e;n++){let e=t.get(r,n)-o*t.get(s,n);t.set(r,n,e)}}s--}return t}set(){throw Error("set method is unimplemented")}get(){throw Error("get method is unimplemented")}repeat(t={}){if("object"!=typeof t)throw TypeError("options must be an object");let{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw TypeError("columns must be a positive integer");let s=new Matrix(this.rows*e,this.columns*r);for(let t=0;t<e;t++)for(let e=0;e<r;e++)s.setSubMatrix(this,this.rows*t,this.columns*e);return s}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){checkRowIndex(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return Matrix.rowVector(this.getRow(t))}setRow(t,e){checkRowIndex(this,t),e=checkRowVector(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){checkRowIndex(this,t),checkRowIndex(this,e);for(let r=0;r<this.columns;r++){let s=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,s)}return this}getColumn(t){checkColumnIndex(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return Matrix.columnVector(this.getColumn(t))}setColumn(t,e){checkColumnIndex(this,t),e=checkColumnVector(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){checkColumnIndex(this,t),checkColumnIndex(this,e);for(let r=0;r<this.rows;r++){let s=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,s)}return this}addRowVector(t){t=checkRowVector(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=checkRowVector(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=checkRowVector(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=checkRowVector(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=checkColumnVector(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=checkColumnVector(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=checkColumnVector(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=checkColumnVector(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){checkRowIndex(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){checkColumnIndex(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{let t=Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{let t=Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw Error(`invalid option: ${t}`)}}maxIndex(){checkNonEmpty(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.get(r,s)>t&&(t=this.get(r,s),e[0]=r,e[1]=s);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{let t=Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{let t=Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw Error(`invalid option: ${t}`)}}minIndex(){checkNonEmpty(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let s=0;s<this.columns;s++)this.get(r,s)<t&&(t=this.get(r,s),e[0]=r,e[1]=s);return e}maxRow(t){if(checkRowIndex(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){checkRowIndex(this,t),checkNonEmpty(this);let e=this.get(t,0),r=[t,0];for(let s=1;s<this.columns;s++)this.get(t,s)>e&&(e=this.get(t,s),r[1]=s);return r}minRow(t){if(checkRowIndex(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){checkRowIndex(this,t),checkNonEmpty(this);let e=this.get(t,0),r=[t,0];for(let s=1;s<this.columns;s++)this.get(t,s)<e&&(e=this.get(t,s),r[1]=s);return r}maxColumn(t){if(checkColumnIndex(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){checkColumnIndex(this,t),checkNonEmpty(this);let e=this.get(0,t),r=[0,t];for(let s=1;s<this.rows;s++)this.get(s,t)>e&&(e=this.get(s,t),r[0]=s);return r}minColumn(t){if(checkColumnIndex(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){checkColumnIndex(this,t),checkNonEmpty(this);let e=this.get(0,t),r=[0,t];for(let s=1;s<this.rows;s++)this.get(s,t)<e&&(e=this.get(s,t),r[0]=s);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){AbstractMatrix.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw RangeError("vectors do not have the same size");let r=0;for(let s=0;s<e.length;s++)r+=e[s]*t[s];return r}mmul(t){t=Matrix.checkMatrix(t);let e=this.rows,r=this.columns,s=t.columns,i=new Matrix(e,s),o=new Float64Array(r);for(let n=0;n<s;n++){for(let e=0;e<r;e++)o[e]=t.get(e,n);for(let t=0;t<e;t++){let e=0;for(let s=0;s<r;s++)e+=this.get(t,s)*o[s];i.set(t,n,e)}}return i}strassen2x2(t){t=Matrix.checkMatrix(t);let e=new Matrix(2,2),r=this.get(0,0),s=t.get(0,0),i=this.get(0,1),o=t.get(0,1),n=this.get(1,0),a=t.get(1,0),h=this.get(1,1),l=t.get(1,1),u=(r+h)*(s+l),c=(n+h)*s,f=r*(o-l),m=h*(a-s),g=(r+i)*l;return e.set(0,0,u+m-g+(i-h)*(a+l)),e.set(0,1,f+g),e.set(1,0,c+m),e.set(1,1,u-c+f+(n-r)*(s+o)),e}strassen3x3(t){t=Matrix.checkMatrix(t);let e=new Matrix(3,3),r=this.get(0,0),s=this.get(0,1),i=this.get(0,2),o=this.get(1,0),n=this.get(1,1),a=this.get(1,2),h=this.get(2,0),l=this.get(2,1),u=this.get(2,2),c=t.get(0,0),f=t.get(0,1),m=t.get(0,2),g=t.get(1,0),M=t.get(1,1),w=t.get(1,2),x=t.get(2,0),p=t.get(2,1),b=t.get(2,2),d=(r-o)*(-f+M),y=(-r+o+n)*(c-f+M),A=(o+n)*(-c+f),v=r*c,S=(-r+h+l)*(c-m+w),E=(-r+h)*(m-w),k=(h+l)*(-c+m),R=(-i+l+u)*(M+x-p),I=(i-u)*(M-p),V=i*x,N=(l+u)*(-x+p),C=(-i+n+a)*(w+x-b),D=(i-a)*(w-b),T=(n+a)*(-x+b);return e.set(0,0,v+V+s*g),e.set(0,1,(r+s+i-o-n-l-u)*M+y+A+v+R+V+N),e.set(0,2,v+S+k+(r+s+i-n-a-h-l)*w+V+C+T),e.set(1,0,d+n*(-c+f+g-M-w-x+b)+y+v+V+C+D),e.set(1,1,d+y+A+v+a*p),e.set(1,2,V+C+D+T+o*m),e.set(2,0,v+S+E+l*(-c+m+g-M-w-x+p)+R+I+V),e.set(2,1,R+I+V+N+h*f),e.set(2,2,v+S+E+k+u*b),e}mmulStrassen(t){t=Matrix.checkMatrix(t);let e=this.clone(),r=e.rows,s=e.columns,i=t.rows,o=t.columns;function embed(t,e,r){let s=t.rows,i=t.columns;return s===e&&i===r?t:AbstractMatrix.zeros(e,r).setSubMatrix(t,0,0)}s!==i&&console.warn(`Multiplying ${r} x ${s} and ${i} x ${o} matrix: dimensions do not match.`);let n=Math.max(r,i),a=Math.max(s,o);return function blockMult(t,e,r,s){if(r<=512||s<=512)return t.mmul(e);r%2==1&&s%2==1?(t=embed(t,r+1,s+1),e=embed(e,r+1,s+1)):r%2==1?(t=embed(t,r+1,s),e=embed(e,r+1,s)):s%2==1&&(t=embed(t,r,s+1),e=embed(e,r,s+1));let i=parseInt(t.rows/2,10),o=parseInt(t.columns/2,10),n=t.subMatrix(0,i-1,0,o-1),a=e.subMatrix(0,i-1,0,o-1),h=t.subMatrix(0,i-1,o,t.columns-1),l=e.subMatrix(0,i-1,o,e.columns-1),u=t.subMatrix(i,t.rows-1,0,o-1),c=e.subMatrix(i,e.rows-1,0,o-1),f=t.subMatrix(i,t.rows-1,o,t.columns-1),m=e.subMatrix(i,e.rows-1,o,e.columns-1),g=blockMult(AbstractMatrix.add(n,f),AbstractMatrix.add(a,m),i,o),M=blockMult(AbstractMatrix.add(u,f),a,i,o),w=blockMult(n,AbstractMatrix.sub(l,m),i,o),x=blockMult(f,AbstractMatrix.sub(c,a),i,o),p=blockMult(AbstractMatrix.add(n,h),m,i,o),b=blockMult(AbstractMatrix.sub(u,n),AbstractMatrix.add(a,l),i,o),d=blockMult(AbstractMatrix.sub(h,f),AbstractMatrix.add(c,m),i,o),y=AbstractMatrix.add(g,x);y.sub(p),y.add(d);let A=AbstractMatrix.add(w,p),v=AbstractMatrix.add(M,x),S=AbstractMatrix.sub(g,M);S.add(w),S.add(b);let E=AbstractMatrix.zeros(2*y.rows,2*y.columns);return(E=(E=(E=(E=E.setSubMatrix(y,0,0)).setSubMatrix(A,y.rows,0)).setSubMatrix(v,0,y.columns)).setSubMatrix(S,y.rows,y.columns)).subMatrix(0,r-1,0,s-1)}(e=embed(e,n,a),t=embed(t,n,a),n,a)}scaleRows(t={}){if("object"!=typeof t)throw TypeError("options must be an object");let{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw TypeError("min must be a number");if(!Number.isFinite(r))throw TypeError("max must be a number");if(e>=r)throw RangeError("min must be smaller than max");let s=new Matrix(this.rows,this.columns);for(let t=0;t<this.rows;t++){let o=this.getRow(t);o.length>0&&i(o,{min:e,max:r,output:o}),s.setRow(t,o)}return s}scaleColumns(t={}){if("object"!=typeof t)throw TypeError("options must be an object");let{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw TypeError("min must be a number");if(!Number.isFinite(r))throw TypeError("max must be a number");if(e>=r)throw RangeError("min must be smaller than max");let s=new Matrix(this.rows,this.columns);for(let t=0;t<this.columns;t++){let o=this.getColumn(t);o.length&&i(o,{min:e,max:r,output:o}),s.setColumn(t,o)}return s}flipRows(){let t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),s=this.get(e,this.columns-1-r);this.set(e,r,s),this.set(e,this.columns-1-r,t)}return this}flipColumns(){let t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),s=this.get(this.rows-1-r,e);this.set(r,e,s),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=Matrix.checkMatrix(t);let e=this.rows,r=this.columns,s=t.rows,i=t.columns,o=new Matrix(e*s,r*i);for(let n=0;n<e;n++)for(let e=0;e<r;e++)for(let r=0;r<s;r++)for(let a=0;a<i;a++)o.set(s*n+r,i*e+a,this.get(n,e)*t.get(r,a));return o}kroneckerSum(t){if(t=Matrix.checkMatrix(t),!this.isSquare()||!t.isSquare())throw Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,s=this.kroneckerProduct(Matrix.eye(r,r)),i=Matrix.eye(e,e).kroneckerProduct(t);return s.add(i)}transpose(){let t=new Matrix(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=compareNumbers){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=compareNumbers){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,s){checkRange(this,t,e,r,s);let i=new Matrix(e-t+1,s-r+1);for(let o=t;o<=e;o++)for(let e=r;e<=s;e++)i.set(o-t,e-r,this.get(o,e));return i}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw RangeError("Argument out of range");let s=new Matrix(t.length,r-e+1);for(let i=0;i<t.length;i++)for(let o=e;o<=r;o++){if(t[i]<0||t[i]>=this.rows)throw RangeError(`Row index out of range: ${t[i]}`);s.set(i,o-e,this.get(t[i],o))}return s}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw RangeError("Argument out of range");let s=new Matrix(r-e+1,t.length);for(let i=0;i<t.length;i++)for(let o=e;o<=r;o++){if(t[i]<0||t[i]>=this.columns)throw RangeError(`Column index out of range: ${t[i]}`);s.set(o-e,i,this.get(o,t[i]))}return s}setSubMatrix(t,e,r){if((t=Matrix.checkMatrix(t)).isEmpty())return this;let s=e+t.rows-1,i=r+t.columns-1;checkRange(this,e,s,r,i);for(let s=0;s<t.rows;s++)for(let i=0;i<t.columns;i++)this.set(e+s,r+i,t.get(s,i));return this}selection(t,e){checkRowIndices(this,t),checkColumnIndices(this,e);let r=new Matrix(t.length,e.length);for(let s=0;s<t.length;s++){let i=t[s];for(let t=0;t<e.length;t++){let o=e[t];r.set(s,t,this.get(i,o))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){return this.constructor.copy(this,new Matrix(this.rows,this.columns))}static copy(t,e){for(let[r,s,i]of t.entries())e.set(r,s,i);return e}sum(t){switch(t){case"row":return function(t){let e=newArray(t.rows);for(let r=0;r<t.rows;++r)for(let s=0;s<t.columns;++s)e[r]+=t.get(r,s);return e}(this);case"column":return function(t){let e=newArray(t.columns);for(let r=0;r<t.rows;++r)for(let s=0;s<t.columns;++s)e[s]+=t.get(r,s);return e}(this);case void 0:return function(t){let e=0;for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)e+=t.get(r,s);return e}(this);default:throw Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return function(t){let e=newArray(t.rows,1);for(let r=0;r<t.rows;++r)for(let s=0;s<t.columns;++s)e[r]*=t.get(r,s);return e}(this);case"column":return function(t){let e=newArray(t.columns,1);for(let r=0;r<t.rows;++r)for(let s=0;s<t.columns;++s)e[s]*=t.get(r,s);return e}(this);case void 0:return function(t){let e=1;for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)e*=t.get(r,s);return e}(this);default:throw Error(`invalid option: ${t}`)}}mean(t){let e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw TypeError("options must be an object");let{unbiased:r=!0,mean:i=this.mean(t)}=e;if("boolean"!=typeof r)throw TypeError("unbiased must be a boolean");switch(t){case"row":if(!s.isAnyArray(i))throw TypeError("mean must be an array");return function(t,e,r){let s=t.rows,i=t.columns,o=[];for(let n=0;n<s;n++){let s=0,a=0,h=0;for(let e=0;e<i;e++)s+=h=t.get(n,e)-r[n],a+=h*h;e?o.push((a-s*s/i)/(i-1)):o.push((a-s*s/i)/i)}return o}(this,r,i);case"column":if(!s.isAnyArray(i))throw TypeError("mean must be an array");return function(t,e,r){let s=t.rows,i=t.columns,o=[];for(let n=0;n<i;n++){let i=0,a=0,h=0;for(let e=0;e<s;e++)i+=h=t.get(e,n)-r[n],a+=h*h;e?o.push((a-i*i/s)/(s-1)):o.push((a-i*i/s)/s)}return o}(this,r,i);case void 0:if("number"!=typeof i)throw TypeError("mean must be a number");return function(t,e,r){let s=t.rows,i=t.columns,o=s*i,n=0,a=0,h=0;for(let e=0;e<s;e++)for(let s=0;s<i;s++)n+=h=t.get(e,s)-r,a+=h*h;return e?(a-n*n/o)/(o-1):(a-n*n/o)/o}(this,r,i);default:throw Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"==typeof t&&(e=t,t=void 0);let r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let t=0;t<r.length;t++)r[t]=Math.sqrt(r[t]);return r}center(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw TypeError("options must be an object");let{center:r=this.mean(t)}=e;switch(t){case"row":if(!s.isAnyArray(r))throw TypeError("center must be an array");return!function(t,e){for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)t.set(r,s,t.get(r,s)-e[r])}(this,r),this;case"column":if(!s.isAnyArray(r))throw TypeError("center must be an array");return!function(t,e){for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)t.set(r,s,t.get(r,s)-e[s])}(this,r),this;case void 0:if("number"!=typeof r)throw TypeError("center must be a number");return!function(t,e){for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)t.set(r,s,t.get(r,s)-e)}(this,r),this;default:throw Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"==typeof t&&(e=t,t=void 0),"object"!=typeof e)throw TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=function(t){let e=[];for(let r=0;r<t.rows;r++){let s=0;for(let e=0;e<t.columns;e++)s+=Math.pow(t.get(r,e),2)/(t.columns-1);e.push(Math.sqrt(s))}return e}(this);else if(!s.isAnyArray(r))throw TypeError("scale must be an array");return!function(t,e){for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)t.set(r,s,t.get(r,s)/e[r])}(this,r),this;case"column":if(void 0===r)r=function(t){let e=[];for(let r=0;r<t.columns;r++){let s=0;for(let e=0;e<t.rows;e++)s+=Math.pow(t.get(e,r),2)/(t.rows-1);e.push(Math.sqrt(s))}return e}(this);else if(!s.isAnyArray(r))throw TypeError("scale must be an array");return!function(t,e){for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)t.set(r,s,t.get(r,s)/e[s])}(this,r),this;case void 0:if(void 0===r)r=function(t){let e=t.size-1,r=0;for(let s=0;s<t.columns;s++)for(let i=0;i<t.rows;i++)r+=Math.pow(t.get(i,s),2)/e;return Math.sqrt(r)}(this);else if("number"!=typeof r)throw TypeError("scale must be a number");return!function(t,e){for(let r=0;r<t.rows;r++)for(let s=0;s<t.columns;s++)t.set(r,s,t.get(r,s)/e)}(this,r),this;default:throw Error(`invalid option: ${t}`)}}toString(t){return inspectMatrixWithOptions(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}};function compareNumbers(t,e){return t-e}AbstractMatrix.prototype.klass="Matrix","undefined"!=typeof Symbol&&(AbstractMatrix.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return inspectMatrixWithOptions(this)}),AbstractMatrix.random=AbstractMatrix.rand,AbstractMatrix.randomInt=AbstractMatrix.randInt,AbstractMatrix.diagonal=AbstractMatrix.diag,AbstractMatrix.prototype.diagonal=AbstractMatrix.prototype.diag,AbstractMatrix.identity=AbstractMatrix.eye,AbstractMatrix.prototype.negate=AbstractMatrix.prototype.neg,AbstractMatrix.prototype.tensorProduct=AbstractMatrix.prototype.kroneckerProduct;let Matrix=class Matrix extends AbstractMatrix{data;#t(t,e){if(this.data=[],Number.isInteger(e)&&e>=0)for(let r=0;r<t;r++)this.data.push(new Float64Array(e));else throw TypeError("nColumns must be a positive integer");this.rows=t,this.columns=e}constructor(t,e){if(super(),Matrix.isMatrix(t))this.#t(t.rows,t.columns),Matrix.copy(t,this);else if(Number.isInteger(t)&&t>=0)this.#t(t,e);else if(s.isAnyArray(t)){let r=t;if("number"!=typeof(e=(t=r.length)?r[0].length:0))throw TypeError("Data must be a 2D array with at least one element");this.data=[];for(let s=0;s<t;s++){if(r[s].length!==e)throw RangeError("Inconsistent array dimensions");if(!r[s].every(t=>"number"==typeof t))throw TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[s]))}this.rows=t,this.columns=e}else throw TypeError("First argument must be a positive number or an array")}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return checkRowIndex(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),checkRowIndex(this,t,!0),e=Float64Array.from(checkRowVector(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){checkColumnIndex(this,t);for(let e=0;e<this.rows;e++){let r=new Float64Array(this.columns-1);for(let s=0;s<t;s++)r[s]=this.data[e][s];for(let s=t+1;s<this.columns;s++)r[s-1]=this.data[e][s];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){void 0===e&&(e=t,t=this.columns),checkColumnIndex(this,t,!0),e=checkColumnVector(this,e);for(let r=0;r<this.rows;r++){let s=new Float64Array(this.columns+1),i=0;for(;i<t;i++)s[i]=this.data[r][i];for(s[i++]=e[r];i<this.columns+1;i++)s[i]=this.data[r][i-1];this.data[r]=s}return this.columns+=1,this}};AbstractMatrix.prototype.add=function(t){return"number"==typeof t?this.addS(t):this.addM(t)},AbstractMatrix.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},AbstractMatrix.prototype.addM=function(t){if(t=Matrix.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},AbstractMatrix.add=function(t,e){let r=new Matrix(t);return r.add(e)},AbstractMatrix.prototype.sub=function(t){return"number"==typeof t?this.subS(t):this.subM(t)},AbstractMatrix.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},AbstractMatrix.prototype.subM=function(t){if(t=Matrix.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},AbstractMatrix.sub=function(t,e){let r=new Matrix(t);return r.sub(e)},AbstractMatrix.prototype.subtract=AbstractMatrix.prototype.sub,AbstractMatrix.prototype.subtractS=AbstractMatrix.prototype.subS,AbstractMatrix.prototype.subtractM=AbstractMatrix.prototype.subM,AbstractMatrix.subtract=AbstractMatrix.sub,AbstractMatrix.prototype.mul=function(t){return"number"==typeof t?this.mulS(t):this.mulM(t)},AbstractMatrix.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},AbstractMatrix.prototype.mulM=function(t){if(t=Matrix.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},AbstractMatrix.mul=function(t,e){let r=new Matrix(t);return r.mul(e)},AbstractMatrix.prototype.multiply=AbstractMatrix.prototype.mul,AbstractMatrix.prototype.multiplyS=AbstractMatrix.prototype.mulS,AbstractMatrix.prototype.multiplyM=AbstractMatrix.prototype.mulM,AbstractMatrix.multiply=AbstractMatrix.mul,AbstractMatrix.prototype.div=function(t){return"number"==typeof t?this.divS(t):this.divM(t)},AbstractMatrix.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},AbstractMatrix.prototype.divM=function(t){if(t=Matrix.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},AbstractMatrix.div=function(t,e){let r=new Matrix(t);return r.div(e)},AbstractMatrix.prototype.divide=AbstractMatrix.prototype.div,AbstractMatrix.prototype.divideS=AbstractMatrix.prototype.divS,AbstractMatrix.prototype.divideM=AbstractMatrix.prototype.divM,AbstractMatrix.divide=AbstractMatrix.div,AbstractMatrix.prototype.mod=function(t){return"number"==typeof t?this.modS(t):this.modM(t)},AbstractMatrix.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},AbstractMatrix.prototype.modM=function(t){if(t=Matrix.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},AbstractMatrix.mod=function(t,e){let r=new Matrix(t);return r.mod(e)},AbstractMatrix.prototype.modulus=AbstractMatrix.prototype.mod,AbstractMatrix.prototype.modulusS=AbstractMatrix.prototype.modS,AbstractMatrix.prototype.modulusM=AbstractMatrix.prototype.modM,AbstractMatrix.modulus=AbstractMatrix.mod,AbstractMatrix.prototype.and=function(t){return"number"==typeof t?this.andS(t):this.andM(t)},AbstractMatrix.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},AbstractMatrix.prototype.andM=function(t){if(t=Matrix.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},AbstractMatrix.and=function(t,e){let r=new Matrix(t);return r.and(e)},AbstractMatrix.prototype.or=function(t){return"number"==typeof t?this.orS(t):this.orM(t)},AbstractMatrix.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},AbstractMatrix.prototype.orM=function(t){if(t=Matrix.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},AbstractMatrix.or=function(t,e){let r=new Matrix(t);return r.or(e)},AbstractMatrix.prototype.xor=function(t){return"number"==typeof t?this.xorS(t):this.xorM(t)},AbstractMatrix.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},AbstractMatrix.prototype.xorM=function(t){if(t=Matrix.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},AbstractMatrix.xor=function(t,e){let r=new Matrix(t);return r.xor(e)},AbstractMatrix.prototype.leftShift=function(t){return"number"==typeof t?this.leftShiftS(t):this.leftShiftM(t)},AbstractMatrix.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},AbstractMatrix.prototype.leftShiftM=function(t){if(t=Matrix.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},AbstractMatrix.leftShift=function(t,e){let r=new Matrix(t);return r.leftShift(e)},AbstractMatrix.prototype.signPropagatingRightShift=function(t){return"number"==typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},AbstractMatrix.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},AbstractMatrix.prototype.signPropagatingRightShiftM=function(t){if(t=Matrix.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},AbstractMatrix.signPropagatingRightShift=function(t,e){let r=new Matrix(t);return r.signPropagatingRightShift(e)},AbstractMatrix.prototype.rightShift=function(t){return"number"==typeof t?this.rightShiftS(t):this.rightShiftM(t)},AbstractMatrix.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},AbstractMatrix.prototype.rightShiftM=function(t){if(t=Matrix.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},AbstractMatrix.rightShift=function(t,e){let r=new Matrix(t);return r.rightShift(e)},AbstractMatrix.prototype.zeroFillRightShift=AbstractMatrix.prototype.rightShift,AbstractMatrix.prototype.zeroFillRightShiftS=AbstractMatrix.prototype.rightShiftS,AbstractMatrix.prototype.zeroFillRightShiftM=AbstractMatrix.prototype.rightShiftM,AbstractMatrix.zeroFillRightShift=AbstractMatrix.rightShift,AbstractMatrix.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},AbstractMatrix.not=function(t){let e=new Matrix(t);return e.not()},AbstractMatrix.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},AbstractMatrix.abs=function(t){let e=new Matrix(t);return e.abs()},AbstractMatrix.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},AbstractMatrix.acos=function(t){let e=new Matrix(t);return e.acos()},AbstractMatrix.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},AbstractMatrix.acosh=function(t){let e=new Matrix(t);return e.acosh()},AbstractMatrix.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},AbstractMatrix.asin=function(t){let e=new Matrix(t);return e.asin()},AbstractMatrix.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},AbstractMatrix.asinh=function(t){let e=new Matrix(t);return e.asinh()},AbstractMatrix.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},AbstractMatrix.atan=function(t){let e=new Matrix(t);return e.atan()},AbstractMatrix.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},AbstractMatrix.atanh=function(t){let e=new Matrix(t);return e.atanh()},AbstractMatrix.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},AbstractMatrix.cbrt=function(t){let e=new Matrix(t);return e.cbrt()},AbstractMatrix.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},AbstractMatrix.ceil=function(t){let e=new Matrix(t);return e.ceil()},AbstractMatrix.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},AbstractMatrix.clz32=function(t){let e=new Matrix(t);return e.clz32()},AbstractMatrix.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},AbstractMatrix.cos=function(t){let e=new Matrix(t);return e.cos()},AbstractMatrix.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},AbstractMatrix.cosh=function(t){let e=new Matrix(t);return e.cosh()},AbstractMatrix.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},AbstractMatrix.exp=function(t){let e=new Matrix(t);return e.exp()},AbstractMatrix.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},AbstractMatrix.expm1=function(t){let e=new Matrix(t);return e.expm1()},AbstractMatrix.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},AbstractMatrix.floor=function(t){let e=new Matrix(t);return e.floor()},AbstractMatrix.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},AbstractMatrix.fround=function(t){let e=new Matrix(t);return e.fround()},AbstractMatrix.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},AbstractMatrix.log=function(t){let e=new Matrix(t);return e.log()},AbstractMatrix.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},AbstractMatrix.log1p=function(t){let e=new Matrix(t);return e.log1p()},AbstractMatrix.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},AbstractMatrix.log10=function(t){let e=new Matrix(t);return e.log10()},AbstractMatrix.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},AbstractMatrix.log2=function(t){let e=new Matrix(t);return e.log2()},AbstractMatrix.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},AbstractMatrix.round=function(t){let e=new Matrix(t);return e.round()},AbstractMatrix.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},AbstractMatrix.sign=function(t){let e=new Matrix(t);return e.sign()},AbstractMatrix.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},AbstractMatrix.sin=function(t){let e=new Matrix(t);return e.sin()},AbstractMatrix.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},AbstractMatrix.sinh=function(t){let e=new Matrix(t);return e.sinh()},AbstractMatrix.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},AbstractMatrix.sqrt=function(t){let e=new Matrix(t);return e.sqrt()},AbstractMatrix.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},AbstractMatrix.tan=function(t){let e=new Matrix(t);return e.tan()},AbstractMatrix.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},AbstractMatrix.tanh=function(t){let e=new Matrix(t);return e.tanh()},AbstractMatrix.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},AbstractMatrix.trunc=function(t){let e=new Matrix(t);return e.trunc()},AbstractMatrix.pow=function(t,e){let r=new Matrix(t);return r.pow(e)},AbstractMatrix.prototype.pow=function(t){return"number"==typeof t?this.powS(t):this.powM(t)},AbstractMatrix.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t));return this},AbstractMatrix.prototype.powM=function(t){if(t=Matrix.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,Math.pow(this.get(e,r),t.get(e,r)));return this};let SymmetricMatrix=class SymmetricMatrix extends AbstractMatrix{#e;get size(){return this.#e.size}get rows(){return this.#e.rows}get columns(){return this.#e.columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(t){return Matrix.isMatrix(t)&&"SymmetricMatrix"===t.klassType}static zeros(t){return new this(t)}static ones(t){return new this(t).fill(1)}constructor(t){if(super(),Matrix.isMatrix(t)){if(!t.isSymmetric())throw TypeError("not symmetric data");this.#e=Matrix.copy(t,new Matrix(t.rows,t.rows))}else if(Number.isInteger(t)&&t>=0)this.#e=new Matrix(t,t);else if(this.#e=new Matrix(t),!this.isSymmetric())throw TypeError("not symmetric data")}clone(){let t=new SymmetricMatrix(this.diagonalSize);for(let[e,r,s]of this.upperRightEntries())t.set(e,r,s);return t}toMatrix(){return new Matrix(this)}get(t,e){return this.#e.get(t,e)}set(t,e,r){return this.#e.set(t,e,r),this.#e.set(e,t,r),this}removeCross(t){return this.#e.removeRow(t),this.#e.removeColumn(t),this}addCross(t,e){void 0===e&&(e=t,t=this.diagonalSize);let r=e.slice();return r.splice(t,1),this.#e.addRow(t,r),this.#e.addColumn(t,e),this}applyMask(t){if(t.length!==this.diagonalSize)throw RangeError("Mask size do not match with matrix size");let e=[];for(let[r,s]of t.entries())s||e.push(r);for(let t of(e.reverse(),e))this.removeCross(t);return this}toCompact(){let{diagonalSize:t}=this,e=Array(t*(t+1)/2);for(let r=0,s=0,i=0;i<e.length;i++)e[i]=this.get(s,r),++r>=t&&(r=++s);return e}static fromCompact(t){let e=t.length,r=(Math.sqrt(8*e+1)-1)/2;if(!Number.isInteger(r))throw TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(t)}`);let s=new SymmetricMatrix(r);for(let i=0,o=0,n=0;n<e;n++)s.set(i,o,t[n]),++i>=r&&(i=++o);return s}*upperRightEntries(){for(let t=0,e=0;t<this.diagonalSize;){let r=this.get(t,e);yield[t,e,r],++e>=this.diagonalSize&&(e=++t)}}*upperRightValues(){for(let t=0,e=0;t<this.diagonalSize;){let r=this.get(t,e);yield r,++e>=this.diagonalSize&&(e=++t)}}};SymmetricMatrix.prototype.klassType="SymmetricMatrix";let DistanceMatrix=class DistanceMatrix extends SymmetricMatrix{static isDistanceMatrix(t){return SymmetricMatrix.isSymmetricMatrix(t)&&"DistanceMatrix"===t.klassSubType}constructor(t){if(super(t),!this.isDistance())throw TypeError("Provided arguments do no produce a distance matrix")}set(t,e,r){return t===e&&(r=0),super.set(t,e,r)}addCross(t,e){return void 0===e&&(e=t,t=this.diagonalSize),(e=e.slice())[t]=0,super.addCross(t,e)}toSymmetricMatrix(){return new SymmetricMatrix(this)}clone(){let t=new DistanceMatrix(this.diagonalSize);for(let[e,r,s]of this.upperRightEntries())e!==r&&t.set(e,r,s);return t}toCompact(){let{diagonalSize:t}=this,e=Array((t-1)*t/2);for(let r=1,s=0,i=0;i<e.length;i++)e[i]=this.get(s,r),++r>=t&&(r=++s+1);return e}static fromCompact(t){let e=t.length,r=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(r))throw TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(t)}`);let s=new this(r);for(let i=1,o=0,n=0;n<e;n++)s.set(i,o,t[n]),++i>=r&&(i=++o+1);return s}};DistanceMatrix.prototype.klassSubType="DistanceMatrix";let BaseView=class BaseView extends AbstractMatrix{constructor(t,e,r){super(),this.matrix=t,this.rows=e,this.columns=r}};let MatrixSelectionView=class MatrixSelectionView extends BaseView{constructor(t,e,r){checkRowIndices(t,e),checkColumnIndices(t,r),super(t,e.length,r.length),this.rowIndices=e,this.columnIndices=r}set(t,e,r){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],r),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}};let WrapperMatrix1D=class WrapperMatrix1D extends AbstractMatrix{constructor(t,e={}){let{rows:r=1}=e;if(t.length%r!=0)throw Error("the data length is not divisible by the number of rows");super(),this.rows=r,this.columns=t.length/r,this.data=t}set(t,e,r){let s=this._calculateIndex(t,e);return this.data[s]=r,this}get(t,e){let r=this._calculateIndex(t,e);return this.data[r]}_calculateIndex(t,e){return t*this.columns+e}};let WrapperMatrix2D=class WrapperMatrix2D extends AbstractMatrix{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}};let LuDecomposition=class LuDecomposition{constructor(t){let e,r,s,i,o,n,a,h,l;let u=(t=WrapperMatrix2D.checkMatrix(t)).clone(),c=u.rows,f=u.columns,m=new Float64Array(c),g=1;for(e=0;e<c;e++)m[e]=e;for(r=0,h=new Float64Array(c);r<f;r++){for(e=0;e<c;e++)h[e]=u.get(e,r);for(e=0;e<c;e++){for(s=0,l=Math.min(e,r),o=0;s<l;s++)o+=u.get(e,s)*h[s];h[e]-=o,u.set(e,r,h[e])}for(i=r,e=r+1;e<c;e++)Math.abs(h[e])>Math.abs(h[i])&&(i=e);if(i!==r){for(s=0;s<f;s++)n=u.get(i,s),u.set(i,s,u.get(r,s)),u.set(r,s,n);a=m[i],m[i]=m[r],m[r]=a,g=-g}if(r<c&&0!==u.get(r,r))for(e=r+1;e<c;e++)u.set(e,r,u.get(e,r)/u.get(r,r))}this.LU=u,this.pivotVector=m,this.pivotSign=g}isSingular(){let t=this.LU,e=t.columns;for(let r=0;r<e;r++)if(0===t.get(r,r))return!0;return!1}solve(t){let e,r,s;t=Matrix.checkMatrix(t);let i=this.LU;if(i.rows!==t.rows)throw Error("Invalid matrix dimensions");if(this.isSingular())throw Error("LU matrix is singular");let o=t.columns,n=t.subMatrixRow(this.pivotVector,0,o-1),a=i.columns;for(s=0;s<a;s++)for(e=s+1;e<a;e++)for(r=0;r<o;r++)n.set(e,r,n.get(e,r)-n.get(s,r)*i.get(e,s));for(s=a-1;s>=0;s--){for(r=0;r<o;r++)n.set(s,r,n.get(s,r)/i.get(s,s));for(e=0;e<s;e++)for(r=0;r<o;r++)n.set(e,r,n.get(e,r)-n.get(s,r)*i.get(e,s))}return n}get determinant(){let t=this.LU;if(!t.isSquare())throw Error("Matrix must be square");let e=this.pivotSign,r=t.columns;for(let s=0;s<r;s++)e*=t.get(s,s);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,s=new Matrix(e,r);for(let i=0;i<e;i++)for(let e=0;e<r;e++)i>e?s.set(i,e,t.get(i,e)):i===e?s.set(i,e,1):s.set(i,e,0);return s}get upperTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,s=new Matrix(e,r);for(let i=0;i<e;i++)for(let e=0;e<r;e++)i<=e?s.set(i,e,t.get(i,e)):s.set(i,e,0);return s}get pivotPermutationVector(){return Array.from(this.pivotVector)}};function hypotenuse(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}let QrDecomposition=class QrDecomposition{constructor(t){let e,r,s,i;let o=(t=WrapperMatrix2D.checkMatrix(t)).clone(),n=t.rows,a=t.columns,h=new Float64Array(a);for(s=0;s<a;s++){let t=0;for(e=s;e<n;e++)t=hypotenuse(t,o.get(e,s));if(0!==t){for(0>o.get(s,s)&&(t=-t),e=s;e<n;e++)o.set(e,s,o.get(e,s)/t);for(o.set(s,s,o.get(s,s)+1),r=s+1;r<a;r++){for(i=0,e=s;e<n;e++)i+=o.get(e,s)*o.get(e,r);for(i=-i/o.get(s,s),e=s;e<n;e++)o.set(e,r,o.get(e,r)+i*o.get(e,s))}}h[s]=-t}this.QR=o,this.Rdiag=h}solve(t){let e,r,s,i;t=Matrix.checkMatrix(t);let o=this.QR,n=o.rows;if(t.rows!==n)throw Error("Matrix row dimensions must agree");if(!this.isFullRank())throw Error("Matrix is rank deficient");let a=t.columns,h=t.clone(),l=o.columns;for(s=0;s<l;s++)for(r=0;r<a;r++){for(i=0,e=s;e<n;e++)i+=o.get(e,s)*h.get(e,r);for(i=-i/o.get(s,s),e=s;e<n;e++)h.set(e,r,h.get(e,r)+i*o.get(e,s))}for(s=l-1;s>=0;s--){for(r=0;r<a;r++)h.set(s,r,h.get(s,r)/this.Rdiag[s]);for(e=0;e<s;e++)for(r=0;r<a;r++)h.set(e,r,h.get(e,r)-h.get(s,r)*o.get(e,s))}return h.subMatrix(0,l-1,0,a-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,r=this.QR,s=r.columns,i=new Matrix(s,s);for(t=0;t<s;t++)for(e=0;e<s;e++)t<e?i.set(t,e,r.get(t,e)):t===e?i.set(t,e,this.Rdiag[t]):i.set(t,e,0);return i}get orthogonalMatrix(){let t,e,r,s,i=this.QR,o=i.rows,n=i.columns,a=new Matrix(o,n);for(r=n-1;r>=0;r--){for(t=0;t<o;t++)a.set(t,r,0);for(a.set(r,r,1),e=r;e<n;e++)if(0!==i.get(r,r)){for(s=0,t=r;t<o;t++)s+=i.get(t,r)*a.get(t,e);for(s=-s/i.get(r,r),t=r;t<o;t++)a.set(t,e,a.get(t,e)+s*i.get(t,r))}}return a}};let SingularValueDecomposition=class SingularValueDecomposition{constructor(t,e={}){let r;if((t=WrapperMatrix2D.checkMatrix(t)).isEmpty())throw Error("Matrix must be non-empty");let s=t.rows,i=t.columns,{computeLeftSingularVectors:o=!0,computeRightSingularVectors:n=!0,autoTranspose:a=!1}=e,h=!!o,l=!!n,u=!1;if(s<i){if(a){s=(r=t.transpose()).rows,i=r.columns,u=!0;let e=h;h=l,l=e}else r=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose")}else r=t.clone();let c=Math.min(s,i),f=Math.min(s+1,i),m=new Float64Array(f),g=new Matrix(s,c),M=new Matrix(i,i),w=new Float64Array(i),x=new Float64Array(s),p=new Float64Array(f);for(let t=0;t<f;t++)p[t]=t;let b=Math.min(s-1,i),d=Math.max(0,Math.min(i-2,s)),y=Math.max(b,d);for(let t=0;t<y;t++){if(t<b){m[t]=0;for(let e=t;e<s;e++)m[t]=hypotenuse(m[t],r.get(e,t));if(0!==m[t]){0>r.get(t,t)&&(m[t]=-m[t]);for(let e=t;e<s;e++)r.set(e,t,r.get(e,t)/m[t]);r.set(t,t,r.get(t,t)+1)}m[t]=-m[t]}for(let e=t+1;e<i;e++){if(t<b&&0!==m[t]){let i=0;for(let o=t;o<s;o++)i+=r.get(o,t)*r.get(o,e);i=-i/r.get(t,t);for(let o=t;o<s;o++)r.set(o,e,r.get(o,e)+i*r.get(o,t))}w[e]=r.get(t,e)}if(h&&t<b)for(let e=t;e<s;e++)g.set(e,t,r.get(e,t));if(t<d){w[t]=0;for(let e=t+1;e<i;e++)w[t]=hypotenuse(w[t],w[e]);if(0!==w[t]){w[t+1]<0&&(w[t]=0-w[t]);for(let e=t+1;e<i;e++)w[e]/=w[t];w[t+1]+=1}if(w[t]=-w[t],t+1<s&&0!==w[t]){for(let e=t+1;e<s;e++)x[e]=0;for(let e=t+1;e<s;e++)for(let s=t+1;s<i;s++)x[e]+=w[s]*r.get(e,s);for(let e=t+1;e<i;e++){let i=-w[e]/w[t+1];for(let o=t+1;o<s;o++)r.set(o,e,r.get(o,e)+i*x[o])}}if(l)for(let e=t+1;e<i;e++)M.set(e,t,w[e])}}let A=Math.min(i,s+1);if(b<i&&(m[b]=r.get(b,b)),s<A&&(m[A-1]=0),d+1<A&&(w[d]=r.get(d,A-1)),w[A-1]=0,h){for(let t=b;t<c;t++){for(let e=0;e<s;e++)g.set(e,t,0);g.set(t,t,1)}for(let t=b-1;t>=0;t--)if(0!==m[t]){for(let e=t+1;e<c;e++){let r=0;for(let i=t;i<s;i++)r+=g.get(i,t)*g.get(i,e);r=-r/g.get(t,t);for(let i=t;i<s;i++)g.set(i,e,g.get(i,e)+r*g.get(i,t))}for(let e=t;e<s;e++)g.set(e,t,-g.get(e,t));g.set(t,t,1+g.get(t,t));for(let e=0;e<t-1;e++)g.set(e,t,0)}else{for(let e=0;e<s;e++)g.set(e,t,0);g.set(t,t,1)}}if(l)for(let t=i-1;t>=0;t--){if(t<d&&0!==w[t])for(let e=t+1;e<i;e++){let r=0;for(let s=t+1;s<i;s++)r+=M.get(s,t)*M.get(s,e);r=-r/M.get(t+1,t);for(let s=t+1;s<i;s++)M.set(s,e,M.get(s,e)+r*M.get(s,t))}for(let e=0;e<i;e++)M.set(e,t,0);M.set(t,t,1)}let v=A-1,S=Number.EPSILON;for(;A>0;){let t,e;for(t=A-2;t>=-1&&-1!==t;t--){let e=Number.MIN_VALUE+S*Math.abs(m[t]+Math.abs(m[t+1]));if(Math.abs(w[t])<=e||Number.isNaN(w[t])){w[t]=0;break}}if(t===A-2)e=4;else{let r;for(r=A-1;r>=t&&r!==t;r--){let e=(r!==A?Math.abs(w[r]):0)+(r!==t+1?Math.abs(w[r-1]):0);if(Math.abs(m[r])<=S*e){m[r]=0;break}}r===t?e=3:r===A-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=w[A-2];w[A-2]=0;for(let r=A-2;r>=t;r--){let s=hypotenuse(m[r],e),o=m[r]/s,n=e/s;if(m[r]=s,r!==t&&(e=-n*w[r-1],w[r-1]=o*w[r-1]),l)for(let t=0;t<i;t++)s=o*M.get(t,r)+n*M.get(t,A-1),M.set(t,A-1,-n*M.get(t,r)+o*M.get(t,A-1)),M.set(t,r,s)}break}case 2:{let e=w[t-1];w[t-1]=0;for(let r=t;r<A;r++){let i=hypotenuse(m[r],e),o=m[r]/i,n=e/i;if(m[r]=i,e=-n*w[r],w[r]=o*w[r],h)for(let e=0;e<s;e++)i=o*g.get(e,r)+n*g.get(e,t-1),g.set(e,t-1,-n*g.get(e,r)+o*g.get(e,t-1)),g.set(e,r,i)}break}case 3:{let e=Math.max(Math.abs(m[A-1]),Math.abs(m[A-2]),Math.abs(w[A-2]),Math.abs(m[t]),Math.abs(w[t])),r=m[A-1]/e,o=m[A-2]/e,n=w[A-2]/e,a=m[t]/e,u=w[t]/e,c=((o+r)*(o-r)+n*n)/2,f=r*n*(r*n),x=0;(0!==c||0!==f)&&(x=c<0?0-Math.sqrt(c*c+f):Math.sqrt(c*c+f),x=f/(c+x));let p=(a+r)*(a-r)+x,b=a*u;for(let e=t;e<A-1;e++){let r=hypotenuse(p,b);0===r&&(r=Number.MIN_VALUE);let o=p/r,n=b/r;if(e!==t&&(w[e-1]=r),p=o*m[e]+n*w[e],w[e]=o*w[e]-n*m[e],b=n*m[e+1],m[e+1]=o*m[e+1],l)for(let t=0;t<i;t++)r=o*M.get(t,e)+n*M.get(t,e+1),M.set(t,e+1,-n*M.get(t,e)+o*M.get(t,e+1)),M.set(t,e,r);if(0===(r=hypotenuse(p,b))&&(r=Number.MIN_VALUE),o=p/r,n=b/r,m[e]=r,p=o*w[e]+n*m[e+1],m[e+1]=-n*w[e]+o*m[e+1],b=n*w[e+1],w[e+1]=o*w[e+1],h&&e<s-1)for(let t=0;t<s;t++)r=o*g.get(t,e)+n*g.get(t,e+1),g.set(t,e+1,-n*g.get(t,e)+o*g.get(t,e+1)),g.set(t,e,r)}w[A-2]=p;break}case 4:if(m[t]<=0&&(m[t]=m[t]<0?-m[t]:0,l))for(let e=0;e<=v;e++)M.set(e,t,-M.get(e,t));for(;t<v&&!(m[t]>=m[t+1]);){let e=m[t];if(m[t]=m[t+1],m[t+1]=e,l&&t<i-1)for(let r=0;r<i;r++)e=M.get(r,t+1),M.set(r,t+1,M.get(r,t)),M.set(r,t,e);if(h&&t<s-1)for(let r=0;r<s;r++)e=g.get(r,t+1),g.set(r,t+1,g.get(r,t)),g.set(r,t,e);t++}A--}}if(u){let t=M;M=g,g=t}this.m=s,this.n=i,this.s=m,this.U=g,this.V=M}solve(t){let e=this.threshold,r=this.s.length,s=Matrix.zeros(r,r);for(let t=0;t<r;t++)Math.abs(this.s[t])<=e?s.set(t,t,0):s.set(t,t,1/this.s[t]);let i=this.U,o=this.rightSingularVectors,n=o.mmul(s),a=o.rows,h=i.rows,l=Matrix.zeros(a,h);for(let t=0;t<a;t++)for(let e=0;e<h;e++){let s=0;for(let o=0;o<r;o++)s+=n.get(t,o)*i.get(e,o);l.set(t,e,s)}return l.mmul(t)}solveForDiagonal(t){return this.solve(Matrix.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,s=t.columns,i=new Matrix(r,this.s.length);for(let o=0;o<r;o++)for(let r=0;r<s;r++)Math.abs(this.s[r])>e&&i.set(o,r,t.get(o,r)/this.s[r]);let o=this.U,n=o.rows,a=o.columns,h=new Matrix(r,n);for(let t=0;t<r;t++)for(let e=0;e<n;e++){let r=0;for(let s=0;s<a;s++)r+=i.get(t,s)*o.get(e,s);h.set(t,e,r)}return h}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let s=0,i=r.length;s<i;s++)r[s]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return Matrix.diag(this.s)}};function solve(t,e,r=!1){return(t=WrapperMatrix2D.checkMatrix(t),e=WrapperMatrix2D.checkMatrix(e),r)?new SingularValueDecomposition(t).solve(e):t.isSquare()?new LuDecomposition(t).solve(e):new QrDecomposition(t).solve(e)}let EigenvalueDecomposition=class EigenvalueDecomposition{constructor(t,e={}){let r,s;let{assumeSymmetric:i=!1}=e;if(!(t=WrapperMatrix2D.checkMatrix(t)).isSquare())throw Error("Matrix is not a square matrix");if(t.isEmpty())throw Error("Matrix must be non-empty");let o=t.columns,n=new Matrix(o,o),a=new Float64Array(o),h=new Float64Array(o);if(i||t.isSymmetric()){for(r=0;r<o;r++)for(s=0;s<o;s++)n.set(r,s,t.get(r,s));(function(t,e,r,s){let i,o,n,a,h,l,u,c;for(h=0;h<t;h++)r[h]=s.get(t-1,h);for(a=t-1;a>0;a--){for(l=0,c=0,n=0;l<a;l++)c+=Math.abs(r[l]);if(0===c)for(h=0,e[a]=r[a-1];h<a;h++)r[h]=s.get(a-1,h),s.set(a,h,0),s.set(h,a,0);else{for(l=0;l<a;l++)r[l]/=c,n+=r[l]*r[l];for(i=r[a-1],o=Math.sqrt(n),i>0&&(o=-o),e[a]=c*o,n-=i*o,r[a-1]=i-o,h=0;h<a;h++)e[h]=0;for(h=0;h<a;h++){for(i=r[h],s.set(h,a,i),o=e[h]+s.get(h,h)*i,l=h+1;l<=a-1;l++)o+=s.get(l,h)*r[l],e[l]+=s.get(l,h)*i;e[h]=o}for(h=0,i=0;h<a;h++)e[h]/=n,i+=e[h]*r[h];for(h=0,u=i/(n+n);h<a;h++)e[h]-=u*r[h];for(h=0;h<a;h++){for(i=r[h],o=e[h],l=h;l<=a-1;l++)s.set(l,h,s.get(l,h)-(i*e[l]+o*r[l]));r[h]=s.get(a-1,h),s.set(a,h,0)}}r[a]=n}for(a=0;a<t-1;a++){if(s.set(t-1,a,s.get(a,a)),s.set(a,a,1),0!==(n=r[a+1])){for(l=0;l<=a;l++)r[l]=s.get(l,a+1)/n;for(h=0;h<=a;h++){for(l=0,o=0;l<=a;l++)o+=s.get(l,a+1)*s.get(l,h);for(l=0;l<=a;l++)s.set(l,h,s.get(l,h)-o*r[l])}}for(l=0;l<=a;l++)s.set(l,a+1,0)}for(h=0;h<t;h++)r[h]=s.get(t-1,h),s.set(t-1,h,0);s.set(t-1,t-1,1),e[0]=0})(o,h,a,n),function(t,e,r,s){let i,o,n,a,h,l,u,c,f,m,g,M,w,x,p,b;for(n=1;n<t;n++)e[n-1]=e[n];e[t-1]=0;let d=0,y=0,A=Number.EPSILON;for(l=0;l<t;l++){for(y=Math.max(y,Math.abs(r[l])+Math.abs(e[l])),u=l;u<t&&!(Math.abs(e[u])<=A*y);)u++;if(u>l)do{for(i=r[l],f=hypotenuse(c=(r[l+1]-i)/(2*e[l]),1),c<0&&(f=-f),r[l]=e[l]/(c+f),r[l+1]=e[l]*(c+f),m=r[l+1],o=i-r[l],n=l+2;n<t;n++)r[n]-=o;for(d+=o,c=r[u],M=g=1,w=g,x=e[l+1],p=0,b=0,n=u-1;n>=l;n--)for(h=0,w=M,M=g,b=p,i=g*e[n],o=g*c,f=hypotenuse(c,e[n]),e[n+1]=p*f,p=e[n]/f,c=(g=c/f)*r[n]-p*i,r[n+1]=o+p*(g*i+p*r[n]);h<t;h++)o=s.get(h,n+1),s.set(h,n+1,p*s.get(h,n)+g*o),s.set(h,n,g*s.get(h,n)-p*o);c=-p*b*w*x*e[l]/m,e[l]=p*c,r[l]=g*c}while(Math.abs(e[l])>A*y);r[l]=r[l]+d,e[l]=0}for(n=0;n<t-1;n++){for(h=n,c=r[n],a=n+1;a<t;a++)r[a]<c&&(h=a,c=r[a]);if(h!==n)for(a=0,r[h]=r[n],r[n]=c;a<t;a++)c=s.get(a,n),s.set(a,n,s.get(a,h)),s.set(a,h,c)}}(o,h,a,n)}else{let e=new Matrix(o,o),i=new Float64Array(o);for(s=0;s<o;s++)for(r=0;r<o;r++)e.set(r,s,t.get(r,s));(function(t,e,r,s){let i,o,n,a,h,l,u;let c=t-1;for(l=1;l<=c-1;l++){for(u=0,a=l;a<=c;a++)u+=Math.abs(e.get(a,l-1));if(0!==u){for(n=0,a=c;a>=l;a--)r[a]=e.get(a,l-1)/u,n+=r[a]*r[a];for(o=Math.sqrt(n),r[l]>0&&(o=-o),n-=r[l]*o,r[l]=r[l]-o,h=l;h<t;h++){for(i=0,a=c;a>=l;a--)i+=r[a]*e.get(a,h);for(i/=n,a=l;a<=c;a++)e.set(a,h,e.get(a,h)-i*r[a])}for(a=0;a<=c;a++){for(i=0,h=c;h>=l;h--)i+=r[h]*e.get(a,h);for(i/=n,h=l;h<=c;h++)e.set(a,h,e.get(a,h)-i*r[h])}r[l]=u*r[l],e.set(l,l-1,u*o)}}for(a=0;a<t;a++)for(h=0;h<t;h++)s.set(a,h,a===h?1:0);for(l=c-1;l>=1;l--)if(0!==e.get(l,l-1)){for(a=l+1;a<=c;a++)r[a]=e.get(a,l-1);for(h=l;h<=c;h++){for(o=0,a=l;a<=c;a++)o+=r[a]*s.get(a,h);for(o=o/r[l]/e.get(l,l-1),a=l;a<=c;a++)s.set(a,h,s.get(a,h)+o*r[a])}}})(o,e,i,n),function(t,e,r,s,i){let o,n,a,h,l,u,c,f,m,g,M,w,x,p,b,d=t-1,y=t-1,A=Number.EPSILON,v=0,S=0,E=0,k=0,R=0,I=0,V=0,N=0;for(o=0;o<t;o++)for((o<0||o>y)&&(r[o]=i.get(o,o),e[o]=0),n=Math.max(o-1,0);n<t;n++)S+=Math.abs(i.get(o,n));for(;d>=0;){for(h=d;h>0&&(0===(I=Math.abs(i.get(h-1,h-1))+Math.abs(i.get(h,h)))&&(I=S),!(Math.abs(i.get(h,h-1))<A*I));)h--;if(h===d)i.set(d,d,i.get(d,d)+v),r[d]=i.get(d,d),e[d]=0,d--,N=0;else if(h===d-1){if(c=i.get(d,d-1)*i.get(d-1,d),V=Math.sqrt(Math.abs(k=(E=(i.get(d-1,d-1)-i.get(d,d))/2)*E+c)),i.set(d,d,i.get(d,d)+v),i.set(d-1,d-1,i.get(d-1,d-1)+v),f=i.get(d,d),k>=0){for(V=E>=0?E+V:E-V,r[d-1]=f+V,r[d]=r[d-1],0!==V&&(r[d]=f-c/V),e[d-1]=0,e[d]=0,I=Math.abs(f=i.get(d,d-1))+Math.abs(V),R=Math.sqrt((E=f/I)*E+(k=V/I)*k),E/=R,k/=R,n=d-1;n<t;n++)V=i.get(d-1,n),i.set(d-1,n,k*V+E*i.get(d,n)),i.set(d,n,k*i.get(d,n)-E*V);for(o=0;o<=d;o++)V=i.get(o,d-1),i.set(o,d-1,k*V+E*i.get(o,d)),i.set(o,d,k*i.get(o,d)-E*V);for(o=0;o<=y;o++)V=s.get(o,d-1),s.set(o,d-1,k*V+E*s.get(o,d)),s.set(o,d,k*s.get(o,d)-E*V)}else r[d-1]=f+E,r[d]=f+E,e[d-1]=V,e[d]=-V;d-=2,N=0}else{if(f=i.get(d,d),m=0,c=0,h<d&&(m=i.get(d-1,d-1),c=i.get(d,d-1)*i.get(d-1,d)),10===N){for(v+=f,o=0;o<=d;o++)i.set(o,o,i.get(o,o)-f);f=m=.75*(I=Math.abs(i.get(d,d-1))+Math.abs(i.get(d-1,d-2))),c=-.4375*I*I}if(30===N&&(I=(I=(m-f)/2)*I+c)>0){for(I=Math.sqrt(I),m<f&&(I=-I),I=f-c/((m-f)/2+I),o=0;o<=d;o++)i.set(o,o,i.get(o,o)-I);v+=I,f=m=c=.964}for(N+=1,l=d-2;l>=h&&(I=Math.abs(E=((R=f-(V=i.get(l,l)))*(I=m-V)-c)/i.get(l+1,l)+i.get(l,l+1))+Math.abs(k=i.get(l+1,l+1)-V-R-I)+Math.abs(R=i.get(l+2,l+1)),E/=I,k/=I,R/=I,!(l===h||Math.abs(i.get(l,l-1))*(Math.abs(k)+Math.abs(R))<A*(Math.abs(E)*(Math.abs(i.get(l-1,l-1))+Math.abs(V)+Math.abs(i.get(l+1,l+1))))));)l--;for(o=l+2;o<=d;o++)i.set(o,o-2,0),o>l+2&&i.set(o,o-3,0);for(a=l;a<=d-1&&(p=a!==d-1,a!==l&&0!==(f=Math.abs(E=i.get(a,a-1))+Math.abs(k=i.get(a+1,a-1))+Math.abs(R=p?i.get(a+2,a-1):0))&&(E/=f,k/=f,R/=f),0!==f);a++)if(I=Math.sqrt(E*E+k*k+R*R),E<0&&(I=-I),0!==I){for(a!==l?i.set(a,a-1,-I*f):h!==l&&i.set(a,a-1,-i.get(a,a-1)),E+=I,f=E/I,m=k/I,V=R/I,k/=E,R/=E,n=a;n<t;n++)E=i.get(a,n)+k*i.get(a+1,n),p&&(E+=R*i.get(a+2,n),i.set(a+2,n,i.get(a+2,n)-E*V)),i.set(a,n,i.get(a,n)-E*f),i.set(a+1,n,i.get(a+1,n)-E*m);for(o=0;o<=Math.min(d,a+3);o++)E=f*i.get(o,a)+m*i.get(o,a+1),p&&(E+=V*i.get(o,a+2),i.set(o,a+2,i.get(o,a+2)-E*R)),i.set(o,a,i.get(o,a)-E),i.set(o,a+1,i.get(o,a+1)-E*k);for(o=0;o<=y;o++)E=f*s.get(o,a)+m*s.get(o,a+1),p&&(E+=V*s.get(o,a+2),s.set(o,a+2,s.get(o,a+2)-E*R)),s.set(o,a,s.get(o,a)-E),s.set(o,a+1,s.get(o,a+1)-E*k)}}}if(0!==S){for(d=t-1;d>=0;d--)if(E=r[d],0===(k=e[d]))for(h=d,i.set(d,d,1),o=d-1;o>=0;o--){for(c=i.get(o,o)-E,R=0,n=h;n<=d;n++)R+=i.get(o,n)*i.get(n,d);if(e[o]<0)V=c,I=R;else if(h=o,0===e[o]?i.set(o,d,0!==c?-R/c:-R/(A*S)):(f=i.get(o,o+1),m=i.get(o+1,o),u=(f*I-V*R)/(k=(r[o]-E)*(r[o]-E)+e[o]*e[o]),i.set(o,d,u),i.set(o+1,d,Math.abs(f)>Math.abs(V)?(-R-c*u)/f:(-I-m*u)/V)),A*(u=Math.abs(i.get(o,d)))*u>1)for(n=o;n<=d;n++)i.set(n,d,i.get(n,d)/u)}else if(k<0)for(h=d-1,Math.abs(i.get(d,d-1))>Math.abs(i.get(d-1,d))?(i.set(d-1,d-1,k/i.get(d,d-1)),i.set(d-1,d,-(i.get(d,d)-E)/i.get(d,d-1))):(b=cdiv(0,-i.get(d-1,d),i.get(d-1,d-1)-E,k),i.set(d-1,d-1,b[0]),i.set(d-1,d,b[1])),i.set(d,d-1,0),i.set(d,d,1),o=d-2;o>=0;o--){for(g=0,M=0,n=h;n<=d;n++)g+=i.get(o,n)*i.get(n,d-1),M+=i.get(o,n)*i.get(n,d);if(c=i.get(o,o)-E,e[o]<0)V=c,R=g,I=M;else if(h=o,0===e[o]?(b=cdiv(-g,-M,c,k),i.set(o,d-1,b[0]),i.set(o,d,b[1])):(f=i.get(o,o+1),m=i.get(o+1,o),w=(r[o]-E)*(r[o]-E)+e[o]*e[o]-k*k,x=(r[o]-E)*2*k,0===w&&0===x&&(w=A*S*(Math.abs(c)+Math.abs(k)+Math.abs(f)+Math.abs(m)+Math.abs(V))),b=cdiv(f*R-V*g+k*M,f*I-V*M-k*g,w,x),i.set(o,d-1,b[0]),i.set(o,d,b[1]),Math.abs(f)>Math.abs(V)+Math.abs(k)?(i.set(o+1,d-1,(-g-c*i.get(o,d-1)+k*i.get(o,d))/f),i.set(o+1,d,(-M-c*i.get(o,d)-k*i.get(o,d-1))/f)):(b=cdiv(-R-m*i.get(o,d-1),-I-m*i.get(o,d),V,k),i.set(o+1,d-1,b[0]),i.set(o+1,d,b[1]))),A*(u=Math.max(Math.abs(i.get(o,d-1)),Math.abs(i.get(o,d))))*u>1)for(n=o;n<=d;n++)i.set(n,d-1,i.get(n,d-1)/u),i.set(n,d,i.get(n,d)/u)}for(o=0;o<t;o++)if(o<0||o>y)for(n=o;n<t;n++)s.set(o,n,i.get(o,n));for(n=t-1;n>=0;n--)for(o=0;o<=y;o++){for(a=0,V=0;a<=Math.min(n,y);a++)V+=s.get(o,a)*i.get(a,n);s.set(o,n,V)}}}(o,h,a,n,e)}this.n=o,this.e=h,this.d=a,this.V=n}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,r=this.n,s=this.e,i=this.d,o=new Matrix(r,r);for(t=0;t<r;t++){for(e=0;e<r;e++)o.set(t,e,0);o.set(t,t,i[t]),s[t]>0?o.set(t,t+1,s[t]):s[t]<0&&o.set(t,t-1,s[t])}return o}};function cdiv(t,e,r,s){let i,o;return Math.abs(r)>Math.abs(s)?(i=s/r,o=r+i*s,[(t+i*e)/o,(e-i*t)/o]):(i=r/s,o=s+i*r,[(i*t+e)/o,(i*e-t)/o])}let CholeskyDecomposition=class CholeskyDecomposition{constructor(t){let e,r,s;if(!(t=WrapperMatrix2D.checkMatrix(t)).isSymmetric())throw Error("Matrix is not symmetric");let i=t.rows,o=new Matrix(i,i),n=!0;for(r=0;r<i;r++){let a=0;for(s=0;s<r;s++){let i=0;for(e=0;e<s;e++)i+=o.get(s,e)*o.get(r,e);i=(t.get(r,s)-i)/o.get(s,s),o.set(r,s,i),a+=i*i}for(n&=(a=t.get(r,r)-a)>0,o.set(r,r,Math.sqrt(Math.max(a,0))),s=r+1;s<i;s++)o.set(r,s,0)}this.L=o,this.positiveDefinite=!!n}isPositiveDefinite(){return this.positiveDefinite}solve(t){let e,r,s;t=WrapperMatrix2D.checkMatrix(t);let i=this.L,o=i.rows;if(t.rows!==o)throw Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw Error("Matrix is not positive definite");let n=t.columns,a=t.clone();for(s=0;s<o;s++)for(r=0;r<n;r++){for(e=0;e<s;e++)a.set(s,r,a.get(s,r)-a.get(e,r)*i.get(s,e));a.set(s,r,a.get(s,r)/i.get(s,s))}for(s=o-1;s>=0;s--)for(r=0;r<n;r++){for(e=s+1;e<o;e++)a.set(s,r,a.get(s,r)-a.get(e,r)*i.get(e,s));a.set(s,r,a.get(s,r)/i.get(s,s))}return a}get lowerTriangularMatrix(){return this.L}};let nipals=class nipals{constructor(t,e={}){let r,i,o,n,a;t=WrapperMatrix2D.checkMatrix(t);let{Y:h}=e,{scaleScores:l=!1,maxIterations:u=1e3,terminationCriteria:c=1e-10}=e;if(h){if((h=s.isAnyArray(h)&&"number"==typeof h[0]?Matrix.columnVector(h):WrapperMatrix2D.checkMatrix(h)).rows!==t.rows)throw Error("Y should have the same number of rows as X");r=h.getColumnVector(0)}else r=t.getColumnVector(0);let f=1;for(let e=0;e<u&&f>c;e++)n=(n=t.transpose().mmul(r).div(r.transpose().mmul(r).get(0,0))).div(n.norm()),i=t.mmul(n).div(n.transpose().mmul(n).get(0,0)),e>0&&(f=i.clone().sub(a).pow(2).sum()),a=i.clone(),h?(o=(o=h.transpose().mmul(i).div(i.transpose().mmul(i).get(0,0))).div(o.norm()),r=h.mmul(o).div(o.transpose().mmul(o).get(0,0))):r=i;if(h){let e=t.transpose().mmul(i).div(i.transpose().mmul(i).get(0,0));e=e.div(e.norm());let s=t.clone().sub(i.clone().mmul(e.transpose())),a=r.transpose().mmul(i).div(i.transpose().mmul(i).get(0,0)),l=h.clone().sub(i.clone().mulS(a.get(0,0)).mmul(o.transpose()));this.t=i,this.p=e.transpose(),this.w=n.transpose(),this.q=o,this.u=r,this.s=i.transpose().mmul(i),this.xResidual=s,this.yResidual=l,this.betas=a}else this.w=n.transpose(),this.s=i.transpose().mmul(i).sqrt(),l?this.t=i.clone().div(this.s.get(0,0)):this.t=i,this.xResidual=t.sub(i.mmul(n.transpose()))}};e.XA=AbstractMatrix,e.a_=CholeskyDecomposition,e.yQ=CholeskyDecomposition,e.Hs=DistanceMatrix,e.Ec=EigenvalueDecomposition,e.dx=EigenvalueDecomposition,e.LU=LuDecomposition,e.Rm=LuDecomposition,e.y3=Matrix,e.qK=class extends BaseView{constructor(t,e){checkColumnIndices(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,r){return this.matrix.set(t,this.columnIndices[e],r),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}},e.pb=class extends BaseView{constructor(t,e){checkColumnIndex(t,e),super(t,t.rows,1),this.column=e}set(t,e,r){return this.matrix.set(t,this.column,r),this}get(t){return this.matrix.get(t,this.column)}},e.j=class extends BaseView{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(t,this.columns-e-1,r),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}},e.sO=class extends BaseView{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(this.rows-t-1,e,r),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}},e.BZ=class extends BaseView{constructor(t,e){checkRowIndices(t,e),super(t,e.length,t.columns),this.rowIndices=e}set(t,e,r){return this.matrix.set(this.rowIndices[t],e,r),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}},e.EK=class extends BaseView{constructor(t,e){checkRowIndex(t,e),super(t,1,t.columns),this.row=e}set(t,e,r){return this.matrix.set(this.row,e,r),this}get(t,e){return this.matrix.get(this.row,e)}},e.Db=MatrixSelectionView,e.Fx=class extends BaseView{constructor(t,e,r,s,i){checkRange(t,e,r,s,i),super(t,r-e+1,i-s+1),this.startRow=e,this.startColumn=s}set(t,e,r){return this.matrix.set(this.startRow+t,this.startColumn+e,r),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}},e.tU=class extends BaseView{constructor(t){super(t,t.columns,t.rows)}set(t,e,r){return this.matrix.set(e,t,r),this}get(t,e){return this.matrix.get(e,t)}},e.Ym=nipals,e.rs=nipals,e.QR=QrDecomposition,e.TB=QrDecomposition,e.oH=SingularValueDecomposition,e.Sc=SingularValueDecomposition,e.BN=SymmetricMatrix,e.it=WrapperMatrix1D,e.$r=WrapperMatrix2D,e.QM=function(t,e=t,r={}){t=new Matrix(t);let i=!1;if("object"!=typeof e||Matrix.isMatrix(e)||s.isAnyArray(e)?e=new Matrix(e):(r=e,e=t,i=!0),t.rows!==e.rows)throw TypeError("Both matrices must have the same number of rows");let{center:o=!0,scale:n=!0}=r;o&&(t.center("column"),i||e.center("column")),n&&(t.scale("column"),i||e.scale("column"));let a=t.standardDeviation("column",{unbiased:!0}),h=i?a:e.standardDeviation("column",{unbiased:!0}),l=t.transpose().mmul(e);for(let e=0;e<l.rows;e++)for(let r=0;r<l.columns;r++)l.set(e,r,l.get(e,r)*(1/(a[e]*h[r]))*(1/(t.rows-1)));return l},e.AV=function(t,e=t,r={}){t=new Matrix(t);let i=!1;if("object"!=typeof e||Matrix.isMatrix(e)||s.isAnyArray(e)?e=new Matrix(e):(r=e,e=t,i=!0),t.rows!==e.rows)throw TypeError("Both matrices must have the same number of rows");let{center:o=!0}=r;o&&(t=t.center("column"),i||(e=e.center("column")));let n=t.transpose().mmul(e);for(let e=0;e<n.rows;e++)for(let r=0;r<n.columns;r++)n.set(e,r,n.get(e,r)*(1/(t.rows-1)));return n},e.GH=function determinant(t){if((t=Matrix.checkMatrix(t)).isSquare()){let e,r,s;if(0===t.columns)return 1;if(2===t.columns)return e=t.get(0,0),r=t.get(0,1),s=t.get(1,0),e*t.get(1,1)-r*s;if(3!==t.columns)return new LuDecomposition(t).determinant;{let i,o,n;return i=new MatrixSelectionView(t,[1,2],[1,2]),o=new MatrixSelectionView(t,[1,2],[0,2]),n=new MatrixSelectionView(t,[1,2],[0,1]),e=t.get(0,0),r=t.get(0,1),s=t.get(0,2),e*determinant(i)-r*determinant(o)+s*determinant(n)}}throw Error("determinant can only be calculated for a square matrix")},e.SO=function(t,e=!1){return(t=WrapperMatrix2D.checkMatrix(t),e)?new SingularValueDecomposition(t).inverse():solve(t,Matrix.eye(t.rows))},e.uZ=function(t,e={}){let{thresholdValue:r=1e-9,thresholdError:s=1e-9}=e,i=(t=Matrix.checkMatrix(t)).rows,o=new Matrix(i,i);for(let e=0;e<i;e++){let n=Matrix.columnVector(t.getRow(e)),a=t.subMatrixRow(function(t,e){let r=[];for(let s=0;s<t;s++)s!==e&&r.push(s);return r}(i,e)).transpose(),h=new SingularValueDecomposition(a).solve(n),l=Matrix.sub(n,a.mmul(h)).abs().max();o.setRow(e,function(t,e,r,s=1e-9,i=1e-9){if(t>i)return Array(e.rows+1).fill(0);{let t=e.addRow(r,[0]);for(let e=0;e<t.rows;e++)Math.abs(t.get(e,0))<s&&t.set(e,0,0);return t.to1DArray()}}(l,h,e,r,s))}return o},e.yU=function(t,e=Number.EPSILON){if((t=Matrix.checkMatrix(t)).isEmpty())return t.transpose();let r=new SingularValueDecomposition(t,{autoTranspose:!0}),s=r.leftSingularVectors,i=r.rightSingularVectors,o=r.diagonal;for(let t=0;t<o.length;t++)Math.abs(o[t])>e?o[t]=1/o[t]:o[t]=0;return i.mmul(Matrix.diag(o).mmul(s.transpose()))},e.F1=solve,e.re=function(t,e){if(s.isAnyArray(t))return t[0]&&s.isAnyArray(t[0])?new WrapperMatrix2D(t):new WrapperMatrix1D(t,e);throw Error("the argument is not an array")}},2138:function(t,e,r){r.d(e,{_:function(){return PCA}});var s=r(8406);s.XA,s.a_,s.yQ,s.Hs;let i=s.Ec;s.dx,s.LU,s.Rm;let o=s.y3;s.qK,s.pb,s.j,s.sO,s.BZ,s.EK,s.Db,s.Fx;let n=s.tU,a=s.Ym;s.rs,s.QR,s.TB;let h=s.oH;s.Sc,s.BN,s.it,s.$r,s.QM,s.AV,s.y3,s.y3,s.GH,s.SO,s.uZ,s.yU,s.F1,s.re;let PCA=class PCA{constructor(t,e={},r){let s;if(this.U=null,this.S=null,r){this.center=r.center,this.scale=r.scale,this.means=r.means,this.stdevs=r.stdevs,this.U=o.checkMatrix(r.U),this.S=r.S,this.R=r.R,this.excludedFeatures=r.excludedFeatures||[];return}Array.isArray(t),s=new o(t);let{isCovarianceMatrix:i=!1,method:a="SVD",nCompNIPALS:l=2,center:u=!0,scale:c=!1,ignoreZeroVariance:f=!1}=e;if(this.center=u,this.scale=c,this.means=null,this.stdevs=null,this.excludedFeatures=[],i){this._computeFromCovarianceMatrix(s);return}switch(this._adjust(s,f),a){case"covarianceMatrix":{let t=new n(s).mmul(s).div(s.rows-1);this._computeFromCovarianceMatrix(t);break}case"NIPALS":this._computeWithNIPALS(s,l);break;case"SVD":{let t=new h(s,{computeLeftSingularVectors:!1,computeRightSingularVectors:!0,autoTranspose:!0});this.U=t.rightSingularVectors;let e=t.diagonal,r=[];for(let t of e)r.push(t*t/(s.rows-1));this.S=r;break}default:throw Error(`unknown method: ${a}`)}}static load(t){if("string"!=typeof t.name)throw TypeError("model must have a name property");if("PCA"!==t.name)throw RangeError(`invalid model: ${t.name}`);return new PCA(void 0,void 0,t)}predict(t,e={}){let r;let{nComponents:s=this.U.columns}=e;if(Array.isArray(t),r=new o(t),this.center&&(r.subRowVector(this.means),this.scale)){for(let t of this.excludedFeatures)r.removeColumn(t);r.divRowVector(this.stdevs)}let i=r.mmul(this.U);return i.subMatrix(0,i.rows-1,0,s-1)}invert(t){let e=(t=o.checkMatrix(t)).mmul(this.U.transpose());return this.center&&(this.scale&&e.mulRowVector(this.stdevs),e.addRowVector(this.means)),e}getExplainedVariance(){let t=0;if(this.S)for(let e of this.S)t+=e;return this.S?this.S.map(e=>e/t):[]}getCumulativeVariance(){let t=this.getExplainedVariance();for(let e=1;e<t.length;e++)t[e]+=t[e-1];return t}getEigenvectors(){return this.U}getEigenvalues(){return this.S}getStandardDeviations(){return this.S.map(t=>Math.sqrt(t))}getLoadings(){return this.U.transpose()}toJSON(){return{name:"PCA",center:this.center,scale:this.scale,means:this.means,stdevs:this.stdevs,U:this.U,S:this.S,excludedFeatures:this.excludedFeatures}}_adjust(t,e){if(this.center){let r=t.mean("column"),s=this.scale?t.standardDeviation("column",{mean:r}):null;if(this.means=r,t.subRowVector(r),this.scale){for(let r=0;r<s.length;r++)if(0===s[r]){if(e)t.removeColumn(r),s.splice(r,1),this.excludedFeatures.push(r),r--;else throw RangeError(`Cannot scale the dataset (standard deviation is zero at index ${r}`)}this.stdevs=s,t.divRowVector(s)}}}_computeFromCovarianceMatrix(t){let e=new i(t,{assumeSymmetric:!0});this.U=e.eigenvectorMatrix,this.U.flipRows(),this.S=e.realEigenvalues,this.S.reverse()}_computeWithNIPALS(t,e){this.U=new o(e,t.columns),this.S=[];let r=t;for(let t=0;t<e;t++){let e=new a(r);this.U.setRow(t,e.w.transpose()),this.S.push(Math.pow(e.s.get(0,0),2)),r=e.xResidual}this.U=this.U.transpose()}}}}]);