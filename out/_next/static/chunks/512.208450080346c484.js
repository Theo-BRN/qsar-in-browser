"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[512],{51772:function(t,e,r){r.d(e,{Z:function(){return Loader}});var a=r(85893),n=r(9008),o=r.n(n);function Loader(t){let{loadingText:e="Processsing..."}=t;return(0,a.jsxs)("div",{style:{textAlign:"center"},children:[(0,a.jsx)(o(),{children:(0,a.jsx)("title",{children:e})}),e,(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:"loader"})})]})}},41983:function(t,e,r){r.d(e,{Z:function(){return ScatterPlot}});var a=r(85893),n=r(67294),o=r(73877),components_D3ColorLegend=()=>{let t=(0,n.useRef)();return(0,n.useEffect)(()=>{(function(t,e){var r={top:10,right:2,bottom:20,left:60},a=o.Ys(t.current).style("height","50px").style("width","500px").style("position","relative").append("canvas").attr("height",1).attr("width",500-r.left-r.right).style("height",50-r.top-r.bottom+"px").style("width",500-r.left-r.right+"px").style("border","1px solid #000").style("position","absolute").style("top",r.top+"px").style("left",r.left+"px").node().getContext("2d"),n=o.BYU().range([0,500-r.left-r.right]).domain(e.domain()),s=a.createImageData(500-r.left-r.right,1);o.w6H(500-r.left-r.right).forEach(function(t){var r=o.B8C(e(n.invert(t)));s.data[4*t]=r.r,s.data[4*t+1]=r.g,s.data[4*t+2]=r.b,s.data[4*t+3]=255}),a.putImageData(s,0,0);var i=o.LLu().scale(n).tickSize(6).ticks(8);o.Ys(t.current).append("svg").attr("height","50px").attr("width","500px").style("position","absolute").style("left","0px").style("top","0px").append("g").attr("class","axis").attr("transform","translate("+r.left+","+(50-r.bottom)+")").call(i)})(t,o.cJy(o.OOA).domain([0,10]))},[]),(0,a.jsx)("div",{ref:t,id:"color-legend"})},s=r(5152),i=r.n(s);let l=i()(()=>Promise.all([r.e(662),r.e(216)]).then(r.bind(r,15216)),{loadableGenerated:{webpack:()=>[15216]},ssr:!1}),Tooltip=t=>{let{interactionData:e}=t;return null===e?null:(0,a.jsxs)("div",{style:{left:.5*e.xPos+10,bottom:.5*e.yPos},className:"tooltip",children:[(0,a.jsx)(l,{structure:e.name,id:"smiles"}),(0,a.jsx)("style",{children:'\n      .tooltip {\n        position: absolute;\n        background-color: rgba(0, 0, 0, 0.8);\n        border-radius: 4px;\n        color: white;\n        font-size: 12px;\n        padding: 4px;\n        margin-left: 15px;\n        transform: translateY(-50%);\n    }\n    \n    /* Add an arrow */\n    .tooltip:after {\n        content: "";\n        position:absolute;\n        border-width: 5px;  /* Arrow width */\n        left: -10px;  /* Arrow width * 2 */\n        top:50%;\n        transform:translateY(-50%);\n        border-color: transparent black transparent transparent;\n    }\n    \n      '})]})};var ScatterPlot=t=>{let{data:e,colorProperty:r,hoverProp:s,xAxisTitle:i,yAxisTitle:l}=t,d=(0,n.useRef)(),[c,h]=(0,n.useState)(null),handleMouseOver=(t,r)=>{let[a,n]=o.cx$(t);h({xPos:a,yPos:n,name:s[e.indexOf(r)]})},handleMouseEnd=()=>{h(null)};return(0,n.useEffect)(()=>{let t={top:10,right:30,bottom:30,left:60},a=800-t.left-t.right,n=600-t.top-t.bottom;o.Wem(e,t=>t.x),o.Wem(e,t=>t.y);let s=o.Ys(d.current).append("svg").attr("width",a+t.left+t.right).attr("height",n+t.top+t.bottom).append("g").attr("transform","translate(".concat(t.left,",").concat(t.top,")")),c=o.sPX().scaleExtent([.5,20]).extent([[0,0],[a,n]]).on("zoom",function(t){let e=t.transform.rescaleX(h),r=t.transform.rescaleY(f);p.call(o.LLu(e)),u.call(o.y4O(r)),v.selectAll("circle").attr("cx",t=>e(t.x)).attr("cy",t=>r(t.y))});s.append("rect").attr("width",a).attr("height",n).style("fill","none").style("pointer-events","all").attr("transform","translate(".concat(t.left,",").concat(t.top,")")).call(c);let h=o.BYU().domain([o.VV$(e,t=>t.x),o.Fp7(e,t=>t.x)]).range([0,a]),p=s.append("g").attr("transform","translate(0,".concat(n,")")).call(o.LLu(h)),f=o.BYU().domain([o.VV$(e,t=>t.y),o.Fp7(e,t=>t.y)]).range([n,0]),u=s.append("g").call(o.y4O(f));s.append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",a).attr("height",n).attr("x",0).attr("y",0);let v=s.append("g").attr("clip-path","url(#clip)"),m=o.cJy().domain([1,10]).interpolator(o.OOA);v.selectAll("circle").data(e).enter().append("circle").attr("cx",t=>h(t.x)).attr("cy",t=>f(t.y)).attr("r",8).style("fill",(t,e)=>m(r[e])).style("opacity",.5).on("mouseenter",handleMouseOver).on("mouseleave",handleMouseEnd),s.append("text").attr("transform","translate(".concat(a/2,",").concat(n+t.top+20,")")).style("text-anchor","middle").style("fill","var(--text-color)").text(i),s.append("text").attr("transform","rotate(-90)").attr("y",0-t.left).attr("x",0-n/2).attr("dy","1em").style("text-anchor","middle").style("fill","var(--text-color)").text(l)},[e]),(0,a.jsxs)("div",{className:"container",style:{position:"relative"},children:[(0,a.jsx)(components_D3ColorLegend,{}),(0,a.jsx)("div",{id:"dataviz_axisZoom",ref:d}),(0,a.jsx)(Tooltip,{interactionData:c})]})}},4756:function(t,e,r){r.r(e),r.d(e,{default:function(){return TSNEPlot}});var a=r(85893),n=r(67294),o=r(91315),s=r(41983),i=r(93851),l=r(51772);function TSNEPlot(){let{ligand:t}=(0,n.useContext)(o.Z),[e,r]=(0,n.useState)(null);var d={};d.epsilon=10,d.perplexity=30,d.dim=2;var c=new i.tSNE(d);(0,n.useEffect)(()=>{setTimeout(()=>{processCompounds()},500)},[]);let processCompounds=async()=>{var e=t.map(t=>t.fingerprint);try{c.initDataRaw(e);for(var a=0;a<1e3;a++)c.step();var n=c.getSolution();let t=await n.map(t=>{let[e,r]=t;return{x:e,y:r}});r(t)}catch(t){console.error("Error:",t)}};return null===e?(0,a.jsx)("div",{className:"main-container",children:(0,a.jsx)(l.Z,{})}):(0,a.jsx)("div",{className:"container",children:(0,a.jsx)(s.Z,{data:e,width:600,height:600,colorProperty:t.map(t=>t.pKi),hoverProp:t.map(t=>t.canonical_smiles),xAxisTitle:"TSNE_Component 1",yAxisTitle:"TSNE_Component 2"})})}},93851:function(t){var e=e||{REVISION:"ALPHA"};!function(t){var assert=function(t,e){if(!t)throw e||"Assertion failed"},getopt=function(t,e,r){return t.hasOwnProperty(e)?t[e]:r},e=!1,r=0,gaussRandom=function(){if(e)return e=!1,r;var t=2*Math.random()-1,a=2*Math.random()-1,n=t*t+a*a;if(0==n||n>1)return gaussRandom();var o=Math.sqrt(-2*Math.log(n)/n);return r=a*o,e=!0,t*o},zeros=function(t){if(void 0===t||isNaN(t))return[];if("undefined"!=typeof ArrayBuffer)return new Float64Array(t);for(var e=Array(t),r=0;r<t;r++)e[r]=0;return e},randn2d=function(t,e,r){for(var a=void 0!==r,n=[],o=0;o<t;o++){for(var s=[],i=0;i<e;i++)a?s.push(r):s.push(0+1e-4*gaussRandom());n.push(s)}return n},L2=function(t,e){for(var r=t.length,a=0,n=0;n<r;n++){var o=t[n],s=e[n];a+=(o-s)*(o-s)}return a},xtod=function(t){for(var e=t.length,r=zeros(e*e),a=0;a<e;a++)for(var n=a+1;n<e;n++){var o=L2(t[a],t[n]);r[a*e+n]=o,r[n*e+a]=o}return r},d2p=function(t,e,r){var a=Math.sqrt(t.length),n=Math.floor(a);assert(n===a,"D should have square number of elements.");for(var o=Math.log(e),s=zeros(n*n),i=zeros(n),l=0;l<n;l++){for(var d=-1/0,c=1/0,h=1,p=!1,f=0;!p;){for(var u=0,v=0;v<n;v++){var m=Math.exp(-t[l*n+v]*h);l===v&&(m=0),i[v]=m,u+=m}for(var x=0,v=0;v<n;v++){if(0==u)var m=0;else var m=i[v]/u;i[v]=m,m>1e-7&&(x-=m*Math.log(m))}x>o?(d=h,c===1/0?h*=2:h=(h+c)/2):(c=h,d===-1/0?h/=2:h=(h+d)/2),Math.abs(x-o)<r&&(p=!0),++f>=50&&(p=!0)}for(var v=0;v<n;v++)s[l*n+v]=i[v]}for(var g=zeros(n*n),y=2*n,l=0;l<n;l++)for(var v=0;v<n;v++)g[l*n+v]=Math.max((s[l*n+v]+s[v*n+l])/y,1e-100);return g};function sign(t){return t>0?1:t<0?-1:0}var tSNE=function(t){var t=t||{};this.perplexity=getopt(t,"perplexity",30),this.dim=getopt(t,"dim",2),this.epsilon=getopt(t,"epsilon",10),this.iter=0};tSNE.prototype={initDataRaw:function(t){var e=t.length,r=t[0].length;assert(e>0," X is empty? You must have some data!"),assert(r>0," X[0] is empty? Where is the data?");var a=xtod(t);this.P=d2p(a,this.perplexity,1e-4),this.N=e,this.initSolution()},initDataDist:function(t){var e=t.length;assert(e>0," X is empty? You must have some data!");for(var r=zeros(e*e),a=0;a<e;a++)for(var n=a+1;n<e;n++){var o=t[a][n];r[a*e+n]=o,r[n*e+a]=o}this.P=d2p(r,this.perplexity,1e-4),this.N=e,this.initSolution()},initSolution:function(){this.Y=randn2d(this.N,this.dim),this.gains=randn2d(this.N,this.dim,1),this.ystep=randn2d(this.N,this.dim,0),this.iter=0},getSolution:function(){return this.Y},step:function(){this.iter+=1;for(var t=this.N,e=this.costGrad(this.Y),r=e.cost,a=e.grad,n=zeros(this.dim),o=0;o<t;o++)for(var s=0;s<this.dim;s++){var i=a[o][s],l=this.ystep[o][s],d=this.gains[o][s],c=sign(i)===sign(l)?.8*d:d+.2;c<.01&&(c=.01),this.gains[o][s]=c;var h=(this.iter<250?.5:.8)*l-this.epsilon*c*a[o][s];this.ystep[o][s]=h,this.Y[o][s]+=h,n[s]+=this.Y[o][s]}for(var o=0;o<t;o++)for(var s=0;s<this.dim;s++)this.Y[o][s]-=n[s]/t;return r},debugGrad:function(){var t=this.N,e=this.costGrad(this.Y);e.cost;for(var r=e.grad,a=0;a<t;a++)for(var n=0;n<this.dim;n++){var o=this.Y[a][n];this.Y[a][n]=o+1e-5;var s=this.costGrad(this.Y);this.Y[a][n]=o-1e-5;var i=this.costGrad(this.Y),l=r[a][n];console.log(a+","+n+": gradcheck analytic: "+l+" vs. numerical: "+(s.cost-i.cost)/2e-5),this.Y[a][n]=o}},costGrad:function(t){for(var e=this.N,r=this.dim,a=this.P,n=this.iter<100?4:1,o=zeros(e*e),s=0,i=0;i<e;i++)for(var l=i+1;l<e;l++){for(var d=0,c=0;c<r;c++){var h=t[i][c]-t[l][c];d+=h*h}var p=1/(1+d);o[i*e+l]=p,o[l*e+i]=p,s+=2*p}for(var f=e*e,u=zeros(f),v=0;v<f;v++)u[v]=Math.max(o[v]/s,1e-100);for(var m=0,x=[],i=0;i<e;i++){for(var g=Array(r),c=0;c<r;c++)g[c]=0;for(var l=0;l<e;l++){m+=-a[i*e+l]*Math.log(u[i*e+l]);for(var y=4*(n*a[i*e+l]-u[i*e+l])*o[i*e+l],c=0;c<r;c++)g[c]+=y*(t[i][c]-t[l][c])}x.push(g)}return{cost:m,grad:x}}},t.tSNE=tSNE}(e),void 0===t.exports?window.tsnejs=e:t.exports=e}}]);