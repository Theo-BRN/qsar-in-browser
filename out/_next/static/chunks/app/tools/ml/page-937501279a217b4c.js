(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[577],{5286:function(e,t,a){Promise.resolve().then(a.bind(a,8334))},8334:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return ML}});var r=a(7437),s=a(2265),l=a(4938),n=a(8843),i=a(4033),o=a(6462),u=a(52),d=a(1865),c=a(879),BarChart=e=>{let{mae:t,r2:a}=e;if(!t||!a||t.length!==a.length)return(0,r.jsx)("div",{children:"Error: Both mae and r2 arrays are required and must have the same length."});let l=(0,s.useRef)();return(0,s.useEffect)(()=>{let e={top:10,right:30,bottom:40,left:70},r=800-e.left-e.right,s=400-e.top-e.bottom,n=c.Ys(l.current).select("svg");if(n.empty()){let n=c.Ys(l.current).append("svg").attr("width",r+e.left+e.right).attr("height",s+e.top+e.bottom).append("g").attr("transform","translate(".concat(e.left,",").concat(e.top,")")),i=Array.from({length:t.length},(e,t)=>"Fold ".concat(t+1)),o=["MAE","R2"],u=c.tiA().domain(i).range([0,r]).padding([.2]);n.append("g").attr("transform","translate(0, ".concat(s,")")).call(c.LLu(u).tickSize(0));let d=c.BYU().domain([0,c.Fp7([...t,...a])]).range([s,0]);n.append("g").call(c.y4O(d));let m=c.tiA().domain(o).range([0,u.bandwidth()]).padding([.05]),h=c.PKp().domain(o).range(["#e41a1c","#377eb8"]);n.append("g").selectAll("g").data(i).join("g").attr("transform",e=>"translate(".concat(u(e),", 0)")).selectAll("rect").data(function(e,r){return o.map(e=>({key:e,value:"MAE"===e?t[r]:a[r]}))}).join("rect").attr("x",e=>m(e.key)).attr("y",e=>d(e.value)).attr("width",m.bandwidth()).attr("height",e=>s-d(e.value)).attr("fill",e=>h(e.key));let p=n.append("g").attr("transform","translate(".concat(r-30,", 0)"));p.selectAll("rect").data(o).enter().append("rect").attr("x",0).attr("y",(e,t)=>20*t).attr("width",20).attr("height",10).attr("fill",e=>h(e)),p.selectAll("text").data(o).enter().append("text").attr("x",30).attr("y",(e,t)=>20*t+8).text(e=>e).style("font-size","12px").style("fill","black")}},[t,a]),(0,r.jsx)("div",{id:"my_dataviz",ref:l})};function ML(){let{ligand:e}=(0,s.useContext)(l.Z),{pyodide:t}=(0,s.useContext)(n.Z),{rdkit:a}=(0,s.useContext)(u.Z),[c,m]=(0,s.useState)(""),[h,p]=(0,s.useState)([]),x=(0,s.useRef)(null),[b,f]=(0,s.useState)({width:800,height:600}),[j,g]=(0,s.useState)(!0),{register:v,handleSubmit:_,watch:y,formState:{errors:N}}=(0,d.cI)(),{register:P,handleSubmit:w,watch:S,formState:{errors:C}}=(0,d.cI)();async function onSubmit(a){console.log(a),g(!1),globalThis.model_parameters=a,globalThis.pKi=e.map(e=>e.pKi),globalThis.fp=e.map(e=>e.fingerprint),"#rf"==c?globalThis.opts=1:"#xgboost"==c?(await t.loadPackage(["xgboost"]),globalThis.opts=2):globalThis.opts=3,t.runPython(await (await fetch("/pyodide_ml.py")).text());let r=globalThis.metrics.toJs(),s=r.map(e=>e[0]),l=r.map(e=>e[1]);p([s,l]),g(!0)}return((0,s.useEffect)(()=>{m(window.location.hash)},[(0,i.useSearchParams)()]),j)?(0,r.jsxs)("div",{className:"tools-container",ref:x,children:[(0,r.jsxs)("details",{open:0==h.length,children:[(0,r.jsx)("summary",{children:"Model Settings"}),(0,r.jsx)("p",{style:{margin:"10px 0"},children:"If you are confused, I'd suggest leaving these to the default and just press on Run Model button down below. It'll generate you a report of the model performance."}),"#rf"==c&&(0,r.jsxs)("form",{onSubmit:_(onSubmit),children:[(0,r.jsx)("label",{className:"form-labels",htmlFor:"n_estimators",children:"Number of Estimators: \xa0"}),(0,r.jsx)("input",{id:"n_estimators",className:"input",type:"number",defaultValue:120,...v("n_estimators")}),(0,r.jsx)("br",{}),(0,r.jsx)("label",{className:"form-labels",htmlFor:"criterion",children:"Criterion: \xa0"}),(0,r.jsxs)("select",{id:"criterion",className:"input",defaultValue:1,...v("criterion",{required:!0}),children:[(0,r.jsx)("option",{value:"squared_error",children:"squared_error"}),(0,r.jsx)("option",{value:"absolute_error",children:"absolute_error"}),(0,r.jsx)("option",{value:"friedman_mse",children:"friedman_mse"}),(0,r.jsx)("option",{value:"poisson",children:"poisson"})]}),(0,r.jsx)("br",{}),(0,r.jsx)("label",{className:"form-labels",htmlFor:"max_features",children:"Maximum Features: \xa0"}),(0,r.jsxs)("select",{id:"max_features",className:"input",defaultValue:1,...v("max_features",{required:!0}),children:[(0,r.jsx)("option",{value:"sqrt",children:"sqrt"}),(0,r.jsx)("option",{value:"log2",children:"log2"}),(0,r.jsx)("option",{value:"None",children:"None"})]}),(0,r.jsx)("br",{}),(0,r.jsx)("label",{className:"form-labels",htmlFor:"n_jobs",children:"Number of CPUs: \xa0"}),(0,r.jsx)("input",{id:"n_jobs",className:"input",type:"number",defaultValue:2,...v("n_jobs",{required:!0})}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)("input",{value:"Train and Test RF Model",className:"button",type:"submit"})]}),"#xgboost"==c&&(0,r.jsxs)("form",{onSubmit:w(onSubmit),children:[(0,r.jsx)("label",{className:"form-labels",htmlFor:"learning_rate",children:"Learning Rate: \xa0"}),(0,r.jsx)("input",{className:"input",id:"learning_rate",type:"number",defaultValue:.15,...P("learning_rate")}),(0,r.jsx)("br",{}),(0,r.jsx)("label",{className:"form-labels",htmlFor:"max_depth",children:"Maximum Depth: \xa0"}),(0,r.jsx)("input",{className:"input",id:"max_depth",type:"number",defaultValue:8,...P("max_depth")}),(0,r.jsx)("br",{}),(0,r.jsx)("label",{className:"form-labels",htmlFor:"min_child_weight",children:"Minimum Child Weight: \xa0"}),(0,r.jsx)("input",{className:"input",id:"min_child_weight",type:"number",defaultValue:7,...P("min_child_weight")}),(0,r.jsx)("br",{}),(0,r.jsx)("label",{className:"form-labels",htmlFor:"subsample",children:"Subsample: \xa0"}),(0,r.jsx)("input",{className:"input",id:"subsample",type:"number",defaultValue:1,...P("subsample")}),(0,r.jsx)("br",{}),(0,r.jsx)("label",{className:"form-labels",htmlFor:"colsample_bytree",children:"colsample_bytree: \xa0"}),(0,r.jsx)("input",{className:"input",id:"colsample_bytree",type:"number",defaultValue:1,...P("colsample_bytree")}),(0,r.jsx)("br",{}),(0,r.jsx)("label",{className:"form-labels",htmlFor:"n_jobs",children:"Number of CPUs: \xa0"}),(0,r.jsx)("input",{className:"input",id:"n_jobs",type:"number",defaultValue:2,...P("n_jobs",{required:!0})}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)("input",{value:"Train and Test XGBoost Model",className:"button",type:"submit"})]})]}),0!=h.length&&(0,r.jsx)(BarChart,{mae:h[0],r2:h[1]})]}):(0,r.jsx)("div",{className:"tools-container",children:(0,r.jsx)(o.Z,{})})}},6462:function(e,t,a){"use strict";a.d(t,{Z:function(){return Loader}});var r=a(7437);function Loader(e){let{loadingText:t="Processsing..."}=e;return(0,r.jsxs)("div",{style:{textAlign:"center"},children:[t,(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"loader"})})]})}},4938:function(e,t,a){"use strict";a.d(t,{G:function(){return LigandProvider}});var r=a(7437),s=a(2265);let l=(0,s.createContext)({ligand:[],setLigand:()=>{}});function LigandProvider(e){let{children:t}=e,[a,n]=(0,s.useState)([]);return(0,r.jsx)(l.Provider,{value:{ligand:a,setLigand:n},children:t})}t.Z=l},8843:function(e,t,a){"use strict";a.d(t,{v:function(){return PyodideProvider}});var r=a(7437),s=a(2265);let l=(0,s.createContext)({pyodide:{},setPyodide:()=>{}});function PyodideProvider(e){let{children:t}=e,[a,n]=(0,s.useState)({});return(0,r.jsx)(l.Provider,{value:{pyodide:a,setPyodide:n},children:t})}t.Z=l},52:function(e,t,a){"use strict";a.d(t,{o:function(){return RDKitProvider}});var r=a(7437),s=a(2265);let l=(0,s.createContext)({rdkit:{},setRDKit:()=>{}});function RDKitProvider(e){let{children:t}=e,[a,n]=(0,s.useState)({});return(0,r.jsx)(l.Provider,{value:{rdkit:a,setRDKit:n},children:t})}t.Z=l},4033:function(e,t,a){e.exports=a(290)}},function(e){e.O(0,[291,865,971,864,744],function(){return e(e.s=5286)}),_N_E=e.O()}]);